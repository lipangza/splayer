import{_ as a}from"./Pagination-0Aw9qrf-.js";import{_ as e}from"./MainCover-C4bF_JGP.js";import{_ as l,g as t,a as s,u,q as r,e as o}from"./index-D_KQhQdT.js";import{a7 as n,r as d,w as i,f as c,g as p,G as v,k as y,j as m,n as f,i as h,L as g,T as _,Y as C,aa as k,ac as q,P as b,R as j,J as L,K as z,X as w,W as N,a1 as P,O as R,a_ as S,at as x,ag as O,ai as T,aj as U}from"./vendor-QWMq--4w.js";import"./album-BZa_fuA4.js";import"./dj-BjUMPDZK.js";const G={class:"dsc-playlists"},I={class:"cat-header"},J={key:0,class:"all-cat"},K={key:1,class:"error"},M=l({__name:"playlists",setup(l){const M=t(),Q=s(),W=n(),X=d(Number(W.currentRoute.value.query?.page)||1),Y=d(W.currentRoute.value.query?.cat||"全部歌单"),$=d("true"===W.currentRoute.value.query?.hq),A=d(!1),B=d([]),D=d(!1),E=d(!1),F=d(0),H=(a="全部歌单",e=Q.loadSize,l=0)=>{try{const t=B.value.length,s=t>0?B.value[t-1].updateTime:null;u(a,e,l,$.value,s).then((a=>{F.value=a.total,$.value?(a.more?D.value=!0:D.value=!1,E.value=!1,B.value.push(...r(a.playlists))):(B.value=[],B.value=r(a.playlists))}))}catch(t){D.value=!1,console.error("歌单列表获取失败：",t),$message.error("歌单列表获取失败")}},V=a=>{B.value=[],W.push({path:"/discover/playlists",query:{cat:Y.value,hq:!!a}})},Z=a=>{B.value=[],W.push({path:"/discover/playlists",query:{cat:a,page:1}}),A.value=!1},aa=a=>{B.value=[],W.push({path:"/discover/playlists",query:{cat:Y.value,page:a}})};return i((()=>W.currentRoute.value),(a=>{"dsc-playlists"===a.name&&(X.value=Number(a.query?.page)||1,Y.value=a.query?.cat||"全部歌单",$.value="true"===a.query?.hq,H(Y.value,Q.loadSize,(X.value-1)*Q.loadSize))})),c((()=>{M.setPlCatList(),H(Y.value,Q.loadSize,(X.value-1)*Q.loadSize)})),(l,t)=>{const s=o,u=N,r=P,n=R,d=S,i=k,c=e,Q=a,W=x,ea=O,la=T,ta=U,sa=q;return p(),v("div",G,[y(i,{class:"menu",align:"center",justify:"space-between"},{default:m((()=>[y(r,{class:"cat","icon-placement":"right",strong:"",secondary:"",round:"",onClick:t[0]||(t[0]=a=>A.value=!0)},{icon:m((()=>[y(u,{class:"more",depth:"3"},{default:m((()=>[y(s,{icon:"chevron-right"})])),_:1})])),default:m((()=>[b(" "+j(f(Y)),1)])),_:1}),y(_,{name:"fade",mode:"out-in"},{default:m((()=>{return[(a=f(M).plCatList.hqCatList,e=f(Y),a?.length<=0||"全部歌单"!=e&&!a.some((a=>a.name==e))?g("",!0):(p(),h(i,{key:0,align:"center"},{default:m((()=>[y(n,null,{default:m((()=>[b("精品歌单")])),_:1}),y(d,{value:f($),"onUpdate:value":[t[1]||(t[1]=a=>C($)?$.value=a:null),V],round:!1},null,8,["value"])])),_:1})))];var a,e})),_:1})])),_:1}),y(c,{data:f(B)},null,8,["data"]),f($)?g("",!0):(p(),h(Q,{key:0,totalCount:f(F),pageNumber:f(X),onPageNumberChange:aa},null,8,["totalCount","pageNumber"])),y(_,{name:"fade",mode:"out-in"},{default:m((()=>[y(i,{justify:"center"},{default:m((()=>[f($)&&f(D)?(p(),h(r,{key:0,loading:f(E),class:"load-more",size:"large",strong:"",secondary:"",round:"",onClick:t[2]||(t[2]=()=>{E.value=!0,H(f(Y))})},{default:m((()=>[b(" 加载更多 ")])),_:1},8,["loading"])):g("",!0)])),_:1})])),_:1}),y(sa,{show:f(A),"onUpdate:show":t[4]||(t[4]=a=>C(A)?A.value=a:null),bordered:!1,preset:"card"},{header:m((()=>[L("div",I,[y(n,null,{default:m((()=>[b("歌单分类")])),_:1}),y(W,{type:"全部歌单"==f(Y)?"primary":"default",bordered:!1,round:"",class:"tag",onClick:t[3]||(t[3]=a=>Z("全部歌单"))},{default:m((()=>[b(" 全部歌单 ")])),_:1},8,["type"])])])),default:m((()=>[y(ta,{style:{"max-height":"70vh"}},{default:m((()=>[f(M).plCatList.catList?.length?(p(),v("div",J,[y(la,null,{default:m((()=>[(p(!0),v(z,null,w(f(M).plCatList.allCat,((a,e)=>(p(),h(ea,{key:a},{prefix:m((()=>[y(n,{class:"type"},{default:m((()=>[b(j(a),1)])),_:2},1024)])),default:m((()=>[y(i,null,{default:m((()=>[(p(!0),v(z,null,w(f(M).plCatList.catList.filter((a=>a.category==e)),(a=>(p(),h(W,{key:a,bordered:!1,type:a.name==f(Y)?"primary":"default",round:"",class:"tag",size:"large",onClick:e=>Z(a.name)},{icon:m((()=>[a.hot?(p(),h(u,{key:0,class:"hot"},{default:m((()=>[y(s,{icon:"fire"})])),_:1})):g("",!0)])),default:m((()=>[b(j(a.name)+" ",1)])),_:2},1032,["type","onClick"])))),128))])),_:2},1024)])),_:2},1024)))),128))])),_:1})])):(p(),v("div",K,[y(n,null,{default:m((()=>[b("加载失败")])),_:1})]))])),_:1})])),_:1},8,["show"])])}}},[["__scopeId","data-v-4ea5065b"]]);export{M as default};
