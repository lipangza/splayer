import{_ as a}from"./SongList-DlSTL_cD.js";import{d as e,as as s,b as l,r as t,L as i,f as o,Z as r,cX as n,S as c,R as d,o as u,H as m,k as v,j as p,af as f,ac as g,m as b,cz as h,b8 as y,aR as _,h as k,I as w,cP as x,ad as L,a1 as T,a2 as j,i as S,ae as C,aA as z,aB as I,cV as P,am as R,bJ as q,ai as A,cm as H,cW as B,a8 as F,aj as N,ar as U,b9 as $,aa as D,c6 as G,aq as J,ak as K,b4 as M,K as O}from"./stores-De5JHsxi.js";import{u as V,p as W,o as X,b as Z,c as E}from"./index-tqBPJ7OH.js";import{a as Q}from"./album-9FZAS1rf.js";const Y={key:0,class:"detail"},aa={class:"cover"},ea={class:"data"},sa={class:"item"},la={class:"item"},ta={key:0,class:"item"},ia={key:1,class:"item"},oa={key:1,class:"detail"},ra={class:"data"},na=O(e({__name:"album",setup(e){const O=V(),na=s(),ca=l(),da=t(!1),ua=t(!0),ma=i([]),va=t(null),pa=t(""),fa=t([]),ga=o((()=>Number(O.currentRoute.value.query.id))),ba=t(!1),ha=o((()=>na.userLikeData.albums.some((a=>a.id===va.value?.id)))),ya=o((()=>pa.value?fa.value:ma.value)),_a=o((()=>ca.mainContentHeight-(ba.value?120:240))),ka=o((()=>[{label:"打开源页面",key:"open",props:{onClick:()=>{window.open(`https://music.163.com/#/album?id=${ga.value}`)}},icon:q("Link")}])),wa=async(a,e=!1)=>{if(!a)return;ua.value=!0,La(),e||(ma.value=[],va.value=null);const s=await Q(a);va.value=h(s.album)[0];const l=s.songs.map((a=>a.id)),t=await y(l);ma.value=_(t.songs),ua.value=!1},xa=a=>{const e=a.target.scrollTop;ba.value=e>10},La=()=>{pa.value="",fa.value=[]},Ta=r((()=>{va.value&&ma.value?.length&&W.updatePlayList(ma.value)}),300),ja=r((a=>{if(!(a=a.trim())||""===a)return;const e=n(a,ma.value);fa.value=e}),300);return X((a=>{La();const e=Number(a.query.id);e&&wa(e)})),c((()=>{da.value?wa(ga.value,va.value?.id===ga.value):da.value=!0})),d((()=>{ba.value=!1})),u((()=>{wa(ga.value)})),(e,s)=>{const l=A,t=H,i=B,o=F,r=N,n=U,c=$,d=D,u=G,h=J,y=K,_=a,q=M;return k(),m("div",{class:g(["album",{small:b(ba)}])},[v(f,{name:"fade",mode:"out-in"},{default:p((()=>[b(va)?(k(),m("div",Y,[w("div",aa,[v(l,{src:b(va).coverSize?.m||b(va).cover,"previewed-img-props":{style:{borderRadius:"8px"}},"preview-src":b(va).cover,renderToolbar:b(x),"show-toolbar-tooltip":"",class:"cover-img",onLoad:b(L)},{placeholder:p((()=>s[3]||(s[3]=[w("div",{class:"cover-loading"},[w("img",{src:Z,class:"loading-img",alt:"loading-img"})],-1)]))),_:1},8,["src","preview-src","renderToolbar","onLoad"]),v(l,{class:"cover-shadow","preview-disabled":"",src:b(va).coverSize?.m||b(va).cover},null,8,["src"])]),w("div",ea,[v(i,{class:"name"},{default:p((()=>[v(t,{"line-clamp":1,tooltip:{placement:"bottom"}},{default:p((()=>[T(j(b(va).name||"未知专辑"),1)])),_:1})])),_:1}),v(c,{show:!b(ba),class:"collapse"},{default:p((()=>[b(va).description?(k(),S(t,{key:0,"line-clamp":1,tooltip:{trigger:"click",placement:"bottom",width:"trigger"}},{default:p((()=>[T(j(b(va).description),1)])),_:1})):C("",!0),v(n,{class:"meta"},{default:p((()=>[w("div",sa,[v(o,{name:"Person",depth:3}),Array.isArray(b(va).artists)?(k(),m("div",{key:0,class:"artists text-hidden",onClick:s[0]||(s[0]=a=>b(E)(b(va).artists))},[(k(!0),m(z,null,I(b(va).artists,((a,e)=>(k(),S(r,{key:e,class:"ar"},{default:p((()=>[T(j(a.name||"未知艺术家"),1)])),_:2},1024)))),128))])):(k(),m("div",{key:1,class:"artists text-hidden",onClick:s[1]||(s[1]=a=>b(E)(b(va).artists||""))},[v(r,{class:"ar"},{default:p((()=>[T(j(b(va).artists||"未知艺术家"),1)])),_:1})]))]),w("div",la,[v(o,{name:"Music",depth:3}),v(r,null,{default:p((()=>[T(j(b(va).count),1)])),_:1})]),b(va).updateTime?(k(),m("div",ta,[v(o,{name:"Update",depth:3}),v(r,null,{default:p((()=>[T(j(b(va).updateTime),1)])),_:1})])):b(va).createTime?(k(),m("div",ia,[v(o,{name:"Time",depth:3}),v(r,null,{default:p((()=>[T(j(b(P)(b(va).createTime)),1)])),_:1})])):C("",!0)])),_:1})])),_:1},8,["show"]),v(n,{class:"menu",justify:"space-between"},{default:p((()=>[v(n,{class:"left",align:"flex-end"},{default:p((()=>[v(d,{focusable:!1,disabled:b(ua),loading:b(ua),type:"primary",strong:"",secondary:"",round:"",onClick:b(Ta)},{icon:p((()=>[v(o,{name:"Play"})])),default:p((()=>[T(" "+j(b(ua)?"加载中...":"播放"),1)])),_:1},8,["disabled","loading","onClick"]),v(d,{focusable:!1,strong:"",secondary:"",round:""},{icon:p((()=>[v(o,{name:b(ha)?"Favorite":"FavoriteBorder"},null,8,["name"])])),default:p((()=>[T(" "+j(b(ha)?"取消收藏":"收藏专辑"),1)])),_:1}),v(u,{options:b(ka),trigger:"click",placement:"bottom-start"},{default:p((()=>[v(d,{focusable:!1,class:"more",circle:"",strong:"",secondary:""},{icon:p((()=>[v(o,{name:"List"})])),_:1})])),_:1},8,["options"])])),_:1}),v(n,{class:"right"},{default:p((()=>[b(ma)?.length?(k(),S(h,{key:0,value:b(pa),"onUpdate:value":s[2]||(s[2]=a=>R(pa)?pa.value=a:null),"input-props":{autocomplete:"off"},class:"search",placeholder:"模糊搜索",clearable:"",round:"",onInput:b(ja)},{prefix:p((()=>[v(o,{name:"Search"})])),_:1},8,["value","onInput"])):C("",!0)])),_:1})])),_:1})])])):(k(),m("div",oa,[v(y,{class:"cover"}),w("div",ra,[v(y,{repeat:4,text:""})])]))])),_:1}),v(f,{name:"fade",mode:"out-in"},{default:p((()=>[!b(pa)||b(fa)?.length?(k(),S(_,{key:0,data:b(ya),loading:b(ua),height:b(_a),"hidden-album":"",onScroll:xa},null,8,["data","loading","height"])):(k(),S(q,{key:1,description:`搜不到关于 ${b(pa)} 的任何歌曲呀`,style:{"margin-top":"60px"},size:"large"},{icon:p((()=>[v(o,{name:"SearchOff"})])),_:1},8,["description"]))])),_:1})],2)}}}),[["__scopeId","data-v-03b063fb"]]);export{na as default};
