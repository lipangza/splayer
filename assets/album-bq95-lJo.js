import{_ as a}from"./SongList-CDQnjgGa.js";import{d as e,as as s,b as l,r as t,L as o,f as i,bI as r,Z as n,cW as c,T as d,S as u,o as m,H as v,j as p,n as f,m as g,k as b,J as h,ag as y,ah as _,cN as k,cT as w,cl as T,a7 as x,a8 as L,b9 as j,i as S,af as C,ar as I,a5 as q,aA as z,aB as A,ai as H,cV as N,a6 as P,c5 as R,aq as B,ao as F,aj as U,ae as $,b4 as D,ac as G,cy as J,b8 as K,aR as M,K as O}from"./stores-fvLrIm8G.js";import{u as V,p as W,o as Z,b as E,c as Q}from"./index-CugtlCeX.js";import{a as X}from"./album-DzRjhu8w.js";const Y={key:0,class:"detail"},aa={class:"cover"},ea={class:"data"},sa={class:"item"},la={class:"item"},ta={key:0,class:"item"},oa={key:1,class:"item"},ia={key:1,class:"detail"},ra={class:"data"},na=O(e({__name:"album",setup(e){const O=V(),na=s(),ca=l(),da=t(!1),ua=t(!0),ma=o([]),va=t(null),pa=t(""),fa=t([]),ga=i(()=>Number(O.currentRoute.value.query.id)),ba=t(!1),ha=i(()=>na.userLikeData.albums.some(a=>a.id===va.value?.id)),ya=i(()=>pa.value?fa.value:ma.value),_a=i(()=>ca.mainContentHeight-(ba.value?120:240)),ka=i(()=>[{label:"打开源页面",key:"open",props:{onClick:()=>{window.open(`https://music.163.com/#/album?id=${ga.value}`)}},icon:r("Link")}]),wa=async(a,e=!1)=>{if(!a)return;ua.value=!0,xa(),e||(ma.value=[],va.value=null);const s=await X(a);va.value=J(s.album)[0];const l=s.songs.map(a=>a.id),t=await K(l);ma.value=M(t.songs),ua.value=!1},Ta=a=>{const e=a.target.scrollTop;ba.value=e>10},xa=()=>{pa.value="",fa.value=[]},La=n(()=>{va.value&&ma.value?.length&&W.updatePlayList(ma.value)},300),ja=n(a=>{if(!(a=a.trim())||""===a)return;const e=c(a,ma.value);fa.value=e},300);return Z(a=>{xa();const e=Number(a.query.id);e&&wa(e)}),d(()=>{da.value?wa(ga.value,va.value?.id===ga.value):da.value=!0}),u(()=>{ba.value=!1}),m(()=>{wa(ga.value)}),(e,s)=>{const l=y,t=T,o=w,i=q,r=H,n=I,c=j,d=P,u=R,m=B,J=U,K=a,M=D;return p(),v("div",{class:G(["album",{small:b(ba)}])},[f($,{name:"fade",mode:"out-in"},{default:g(()=>[b(va)?(p(),v("div",Y,[h("div",aa,[f(l,{src:b(va).coverSize?.m||b(va).cover,"previewed-img-props":{style:{borderRadius:"8px"}},"preview-src":b(va).cover,renderToolbar:b(k),"show-toolbar-tooltip":"",class:"cover-img",onLoad:b(_)},{placeholder:g(()=>s[3]||(s[3]=[h("div",{class:"cover-loading"},[h("img",{src:E,class:"loading-img",alt:"loading-img"})],-1)])),_:1},8,["src","preview-src","renderToolbar","onLoad"]),f(l,{class:"cover-shadow","preview-disabled":"",src:b(va).coverSize?.m||b(va).cover},null,8,["src"])]),h("div",ea,[f(o,{class:"name"},{default:g(()=>[f(t,{"line-clamp":1,tooltip:{placement:"bottom"}},{default:g(()=>[x(L(b(va).name||"未知专辑"),1)]),_:1})]),_:1}),f(c,{show:!b(ba),class:"collapse"},{default:g(()=>[b(va).description?(p(),S(t,{key:0,"line-clamp":1,tooltip:{trigger:"click",placement:"bottom",width:"trigger"}},{default:g(()=>[x(L(b(va).description),1)]),_:1})):C("",!0),f(n,{class:"meta"},{default:g(()=>[h("div",sa,[f(i,{name:"Person",depth:3}),Array.isArray(b(va).artists)?(p(),v("div",{key:0,class:"artists text-hidden",onClick:s[0]||(s[0]=a=>b(Q)(b(va).artists))},[(p(!0),v(z,null,A(b(va).artists,(a,e)=>(p(),S(r,{key:e,class:"ar"},{default:g(()=>[x(L(a.name||"未知艺术家"),1)]),_:2},1024))),128))])):(p(),v("div",{key:1,class:"artists text-hidden",onClick:s[1]||(s[1]=a=>b(Q)(b(va).artists||""))},[f(r,{class:"ar"},{default:g(()=>[x(L(b(va).artists||"未知艺术家"),1)]),_:1})]))]),h("div",la,[f(i,{name:"Music",depth:3}),f(r,null,{default:g(()=>[x(L(b(va).count),1)]),_:1})]),b(va).updateTime?(p(),v("div",ta,[f(i,{name:"Update",depth:3}),f(r,null,{default:g(()=>[x(L(b(va).updateTime),1)]),_:1})])):b(va).createTime?(p(),v("div",oa,[f(i,{name:"Time",depth:3}),f(r,null,{default:g(()=>[x(L(b(N)(b(va).createTime)),1)]),_:1})])):C("",!0)]),_:1})]),_:1},8,["show"]),f(n,{class:"menu",justify:"space-between"},{default:g(()=>[f(n,{class:"left",align:"flex-end"},{default:g(()=>[f(d,{focusable:!1,disabled:b(ua),loading:b(ua),type:"primary",strong:"",secondary:"",round:"",onClick:b(La)},{icon:g(()=>[f(i,{name:"Play"})]),default:g(()=>[x(" "+L(b(ua)?"加载中...":"播放"),1)]),_:1},8,["disabled","loading","onClick"]),f(d,{focusable:!1,strong:"",secondary:"",round:""},{icon:g(()=>[f(i,{name:b(ha)?"Favorite":"FavoriteBorder"},null,8,["name"])]),default:g(()=>[x(" "+L(b(ha)?"取消收藏":"收藏专辑"),1)]),_:1}),f(u,{options:b(ka),trigger:"click",placement:"bottom-start"},{default:g(()=>[f(d,{focusable:!1,class:"more",circle:"",strong:"",secondary:""},{icon:g(()=>[f(i,{name:"List"})]),_:1})]),_:1},8,["options"])]),_:1}),f(n,{class:"right"},{default:g(()=>[b(ma)?.length?(p(),S(m,{key:0,value:b(pa),"onUpdate:value":s[2]||(s[2]=a=>F(pa)?pa.value=a:null),"input-props":{autocomplete:"off"},class:"search",placeholder:"模糊搜索",clearable:"",round:"",onInput:b(ja)},{prefix:g(()=>[f(i,{name:"Search"})]),_:1},8,["value","onInput"])):C("",!0)]),_:1})]),_:1})])])):(p(),v("div",ia,[f(J,{class:"cover"}),h("div",ra,[f(J,{repeat:4,text:""})])]))]),_:1}),f($,{name:"fade",mode:"out-in"},{default:g(()=>[!b(pa)||b(fa)?.length?(p(),S(K,{key:0,data:b(ya),loading:b(ua),height:b(_a),"hidden-album":"",onScroll:Ta},null,8,["data","loading","height"])):(p(),S(M,{key:1,description:`搜不到关于 ${b(pa)} 的任何歌曲呀`,style:{"margin-top":"60px"},size:"large"},{icon:g(()=>[f(i,{name:"SearchOff"})]),_:1},8,["description"]))]),_:1})],2)}}}),[["__scopeId","data-v-691b993b"]]);export{na as default};
