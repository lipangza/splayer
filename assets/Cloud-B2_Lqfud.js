import{_ as a}from"./SongList-CDQnjgGa.js";import{d as e,as as s,r as l,L as t,f as o,bI as n,h as u,cW as c,T as i,o as d,bM as r,H as m,j as p,J as f,n as v,m as g,a7 as _,ai as h,a5 as b,ce as y,k as x,d8 as z,a8 as k,ar as S,i as w,af as L,bN as j,a6 as C,c5 as M,aq as P,ao as B,b4 as N,ae as R,aR as $,K as F}from"./stores-fvLrIm8G.js";import{u as G,d as H,p as I,f as W}from"./index-CugtlCeX.js";const q={class:"cloud"},J={class:"title"},K=F(e({__name:"Cloud",setup(e){const F=G(),K=s(),O=l(!1),T=l(!1),U=l(0),A=t(K.cloudPlayList),D=l({size:0,maxSize:0}),E=l(""),Q=l([]),V=o(()=>E.value&&Q.value.length?Q.value:A.value),X=o(()=>"cloud"===F.currentRoute.value.name),Y=o(()=>[{label:"批量操作",key:"batch",props:{onClick:()=>H(A.value,!1)},icon:n("Batch")}]),Z=async()=>{T.value=!0;let a=0;const e=[];do{const s=await W(500,a),l=$(s.data);U.value=s.count,D.value={size:Number((s.size/Math.pow(1024,3)).toFixed(2)),maxSize:Number((s.maxSize/Math.pow(1024,3)).toFixed(0))},e.push(...l),A.value=e,a+=500}while(a<U.value&&X.value);K.setCloudPlayList(A.value),T.value=!1};return u(()=>[E.value,A.value],()=>{const a=E.value.trim();if(!a||""===a||!A.value.length)return;const e=c(a,A.value);Q.value=e},{debounce:300,maxWait:1e3}),i(()=>{O.value?Z():O.value=!0}),d(Z),(e,s)=>{const l=h,t=b,o=y,n=z,u=S,c=C,i=M,d=P,$=a,F=N,G=r("debounce");return p(),m("div",q,[f("div",J,[v(l,{class:"keyword"},{default:g(()=>s[1]||(s[1]=[_("我的云盘")])),_:1,__:[1]}),v(u,{class:"status"},{default:g(()=>[v(l,{class:"item"},{default:g(()=>[v(t,{name:"Music",depth:3}),v(o,{from:0,to:x(U)||x(A)?.length||0},null,8,["to"]),s[2]||(s[2]=_(" 首 "))]),_:1,__:[2]}),v(l,{class:"item"},{default:g(()=>[v(t,{name:"Storage",depth:3}),v(n,{percentage:100/(x(D).maxSize/x(D).size),class:"status",type:"line"},{default:g(()=>[v(l,{class:"space",depth:"3"},{default:g(()=>[_(k(x(D).size??0)+"GB / "+k(x(D).maxSize??0)+"GB ",1)]),_:1})]),_:1},8,["percentage"])]),_:1})]),_:1})]),v(u,{class:"menu",justify:"space-between"},{default:g(()=>[v(u,{class:"left",align:"flex-end"},{default:g(()=>[j((p(),w(c,{focusable:!1,disabled:x(T)||!x(A)?.length,loading:x(T),type:"primary",strong:"",secondary:"",round:""},{icon:g(()=>[v(t,{name:"Play"})]),default:g(()=>[_(" "+k(x(T)?`\n              正在更新... (${x(A).length===x(U)?0:x(A).length}/${x(U)})`:"播放"),1)]),_:1},8,["disabled","loading"])),[[G,()=>x(I).updatePlayList(x(A))]]),v(c,{focusable:!1,class:"more",strong:"",secondary:"",circle:"",onClick:Z},{icon:g(()=>[v(t,{name:"Refresh"})]),_:1}),v(i,{options:x(Y),trigger:"click",placement:"bottom-start"},{default:g(()=>[v(c,{focusable:!1,class:"more",circle:"",strong:"",secondary:""},{icon:g(()=>[v(t,{name:"List"})]),_:1})]),_:1},8,["options"])]),_:1}),x(A)?.length?(p(),w(d,{key:0,value:x(E),"onUpdate:value":s[0]||(s[0]=a=>B(E)?E.value=a:null),"input-props":{autocomplete:"off"},class:"search",placeholder:"模糊搜索",clearable:"",round:""},{prefix:g(()=>[v(t,{name:"Search"})]),_:1},8,["value"])):L("",!0)]),_:1}),v(R,{name:"fade",mode:"out-in"},{default:g(()=>[!x(E)||x(Q)?.length?(p(),w($,{key:0,data:x(V),loading:x(T)},null,8,["data","loading"])):(p(),w(F,{key:1,description:`搜不到关于 ${x(E)} 的任何歌曲呀`,style:{"margin-top":"60px"},size:"large"},{icon:g(()=>[v(t,{name:"SearchOff"})]),_:1},8,["description"]))]),_:1})])}}}),[["__scopeId","data-v-811b30e1"]]);export{K as default};
