import{d as a,aO as e,b as s,r as t,i as l,j as o,c5 as i,k as n,Q as r,bI as c,aY as d,Z as p,d1 as u,aR as y,c$ as m,b8 as v,ae as k,m as g,H as f,ac as _,n as h,af as b,aV as C,aA as P,aB as x,c9 as w,J as j,a5 as I,a8 as M,cU as T,ai as S,a7 as $,bC as z,a6 as q,cV as A,ar as B,aj as D,b4 as L,K as N}from"./stores-fvLrIm8G.js";import{u as O,p as R,h as V}from"./index-CugtlCeX.js";import{a as Y}from"./album-DzRjhu8w.js";const E=a({__name:"CoverMenu",emits:["toPlay"],setup(a,{expose:p,emit:u}){const y=u,m=O(),v=e(),k=s(),g=t(0),f=t(0),_=t(!1),h=t([]);return p({openDropdown:async(a,e,s)=>{try{a.preventDefault(),_.value=!1,r().then(()=>{h.value=[{key:"open",label:"查看详情",props:{onClick:()=>m.push({name:s,query:{id:e.id}})},icon:c("Eye")},{key:"play",label:"播放",show:v.playPlaylistId!==e.id||!k.playStatus,props:{onClick:()=>y("toPlay",e)},icon:c("Play")},{key:"pause",label:"暂停",show:v.playPlaylistId===e.id&&k.playStatus,props:{onClick:()=>y("toPlay",e)},icon:c("Pause")},{key:"line",type:"divider"},{key:"copy",label:"复制链接",props:{onClick:()=>d(`https://music.163.com/#/${s}?id=${e.id}`)},icon:c("Link")}],g.value=a.clientX,f.value=a.clientY,_.value=!0})}catch(t){console.error("右键菜单出现异常：",t),window.$message.error("右键菜单出现异常")}}}),(a,e)=>{const s=i;return o(),l(s,{x:n(g),y:n(f),show:n(_),options:n(h),class:"search-inp-menu",placement:"bottom-start",trigger:"manual",onSelect:e[0]||(e[0]=a=>_.value=!1),onClickoutside:e[1]||(e[1]=a=>_.value=!1)},null,8,["x","y","show","options"])}}}),G=["onClick","onContextmenu"],H={class:"cover"},J={key:0,class:"cover-mask"},K={key:1,class:"play-count"},Q={class:"num"},U={key:1,class:"description"},X={class:"cover-data"},Z={key:2,class:"meta"},F={key:0,class:"artists text-hidden"},W={key:1,class:"artists text-hidden"},aa={class:"cover-item"},ea={class:"cover"},sa={class:"cover-data"},ta=N(a({__name:"CoverList",props:{data:{},type:{},cols:{default:"3 600:3 800:4 900:5 1200:6 1400:7"},loadMore:{type:Boolean},loading:{type:Boolean},loadingNum:{},loadingText:{}},emits:["loadMore"],setup(a,{emit:i}){const r=a,c=i,d=O(),N=e(),ta=s(),la=t(null),oa=p(async a=>{try{if("video"===r.type)return d.push({name:"video",query:{id:a.id}});if(N.playPlaylistId===a.id)return R.playOrPause();a.loading=!0;const e=await ia(a.id);R.updatePlayList(e,void 0,a.id)}catch(e){}finally{a.loading=!1}},300,{leading:!0,trailing:!1}),ia=async a=>{switch(r.type){case"album":{const e=(await Y(a)).songs.map(a=>a.id),s=await v(e);return y(s.songs)}case"playlist":{const e=await m(a,100);return y(e.songs)}case"radio":{const e=await u(a,100);return y(e.programs)}default:return[]}};return(a,e)=>{const s=V,t=I,i=S,p=q,u=w,y=C,m=B,v=D,O=L;return o(),l(k,{name:"fade",mode:"out-in"},{default:g(()=>[a.data.length>0?(o(),f("div",{key:0,class:_(["cover-list",a.type])},[h(y,{cols:a.cols,"x-gap":"20","y-gap":"20"},{default:g(()=>[(o(!0),f(P,null,x(a.data,(c,y)=>(o(),l(u,{key:y},{default:g(()=>[j("div",{class:"cover-item",onClick:a=>(a=>{d.push({name:r.type,query:{id:a.id}})})(c),onContextmenu:e=>n(la)?.openDropdown(e,c,a.type)},[j("div",H,[(o(),l(s,{key:c.cover,src:"video"===a.type?`${c.cover}?param=464y260`:c.coverSize?.m||c.cover,"default-src":"video"!==a.type?"/images/album.jpg?assest":"/images/video.jpg?assest",class:"cover-img",once:""},null,8,["src","default-src"])),c.playCount?(o(),f(P,{key:0},["album"!==a.type?(o(),f("div",J)):b("",!0),"album"!==a.type?(o(),f("div",K,[h(t,{name:"Play"}),j("span",Q,M(n(T)(c.playCount||0)),1)])):b("",!0)],64)):b("",!0),c.description?(o(),f("div",U,[h(i,{class:"text-hidden"},{default:g(()=>[$(M(c.description),1)]),_:2},1024)])):b("",!0),j("div",{class:"play-btn",onClick:e[0]||(e[0]=z(()=>{},["stop"]))},[h(p,{focusable:!1,loading:c.loading,secondary:"",circle:"",class:"play",onClick:z(a=>n(oa)(c),["stop"])},{icon:g(()=>{return[h(t,{size:32,name:(a=c.id,N.playPlaylistId===a&&ta.playStatus?"Pause":"Play")},null,8,["name"])];var a}),_:2},1032,["loading","onClick"])])]),j("div",X,[h(i,{class:"name text-hidden"},{default:g(()=>[$(M(c.name),1)]),_:2},1024),"playlist"!==a.type&&"radio"!==a.type||!c?.creator?.id?b("",!0):(o(),l(i,{key:0,class:"creator",depth:"3"},{default:g(()=>[$(M(c.creator?.name||c.creator||"未知"),1)]),_:2},1024)),c.updateTip?(o(),l(i,{key:1,class:"tip",depth:"3"},{default:g(()=>[$(M(c.updateTip),1)]),_:2},1024)):b("",!0),"album"===a.type?(o(),f("div",Z,[h(i,{class:"count",depth:"3"},{default:g(()=>[$(M(c.count||0)+"首",1)]),_:2},1024),h(i,{class:"date",depth:"3"},{default:g(()=>[$(M(n(A)(c.createTime)),1)]),_:2},1024)])):b("",!0),"video"===a.type&&c.artists?(o(),f(P,{key:3},[Array.isArray(c.artists)?(o(),f("div",F,[(o(!0),f(P,null,x(c.artists,(a,e)=>(o(),l(i,{key:e,class:"ar"},{default:g(()=>[$(M(a.name||"未知艺术家"),1)]),_:2},1024))),128))])):(o(),f("div",W,[h(i,{class:"ar"},{default:g(()=>[$(M(c.artists||"未知艺术家"),1)]),_:2},1024)]))],64)):b("",!0)])],40,G)]),_:2},1024))),128))]),_:1},8,["cols"]),a.loadMore?(o(),l(m,{key:0,class:"load-more",justify:"center"},{default:g(()=>[h(p,{loading:a.loading,size:"large",strong:"",secondary:"",round:"",onClick:e[1]||(e[1]=a=>c("loadMore"))},{default:g(()=>e[2]||(e[2]=[$(" 加载更多 ")])),_:1,__:[2]},8,["loading"])]),_:1})):b("",!0),h(E,{ref_key:"coverMenuRef",ref:la,onToPlay:n(oa)},null,8,["onToPlay"])],2)):a.loading?(o(),f("div",{key:1,class:_(["cover-list","loading",a.type])},[h(y,{cols:a.cols,"x-gap":"20","y-gap":"20"},{default:g(()=>[(o(!0),f(P,null,x(a.loadingNum||50,a=>(o(),l(u,{key:a},{default:g(()=>[j("div",aa,[j("div",ea,[h(v,{class:"cover-img"})]),j("div",sa,[h(v,{text:"",round:"",repeat:2})])])]),_:2},1024))),128))]),_:1},8,["cols"])],2)):(o(),l(O,{key:2,description:"空空如也，怎么什么都没有啊",size:"large"}))]),_:1})}}}),[["__scopeId","data-v-1f83d24e"]]);export{ta as _};
