import{d as a,aO as e,b as s,r as t,h as l,i as o,m as i,P as n,bJ as r,aV as c,c6 as d,Z as p,d2 as u,aR as y,cZ as m,b8 as v,j as k,H as g,k as f,aA as h,aB as _,I as b,ae as C,a2 as P,cU as x,a1 as w,bD as j,cV as I,ac as M,af as T,a8 as S,aj as z,aa as D,c9 as $,aY as q,ar as A,ak as B,b4 as L,K as N}from"./stores-De5JHsxi.js";import{u as O,p as R,h as V}from"./index-tqBPJ7OH.js";import{a as Y}from"./album-9FZAS1rf.js";const Z=a({__name:"CoverMenu",emits:["toPlay"],setup(a,{expose:p,emit:u}){const y=u,m=O(),v=e(),k=s(),g=t(0),f=t(0),h=t(!1),_=t([]);return p({openDropdown:async(a,e,s)=>{try{a.preventDefault(),h.value=!1,n().then((()=>{_.value=[{key:"open",label:"查看详情",props:{onClick:()=>m.push({name:s,query:{id:e.id}})},icon:r("Eye")},{key:"play",label:"播放",show:v.playPlaylistId!==e.id||!k.playStatus,props:{onClick:()=>y("toPlay",e)},icon:r("Play")},{key:"pause",label:"暂停",show:v.playPlaylistId===e.id&&k.playStatus,props:{onClick:()=>y("toPlay",e)},icon:r("Pause")},{key:"line",type:"divider"},{key:"copy",label:"复制链接",props:{onClick:()=>c(`https://music.163.com/#/${s}?id=${e.id}`)},icon:r("Link")}],g.value=a.clientX,f.value=a.clientY,h.value=!0}))}catch(t){console.error("右键菜单出现异常：",t),window.$message.error("右键菜单出现异常")}}}),(a,e)=>{const s=d;return l(),o(s,{x:i(g),y:i(f),show:i(h),options:i(_),class:"search-inp-menu",placement:"bottom-start",trigger:"manual",onSelect:e[0]||(e[0]=a=>h.value=!1),onClickoutside:e[1]||(e[1]=a=>h.value=!1)},null,8,["x","y","show","options"])}}}),E=["onClick","onContextmenu"],G={class:"cover"},H={key:0,class:"cover-mask"},J={key:1,class:"play-count"},K={class:"num"},U={key:1,class:"description"},X={class:"cover-data"},F={key:2,class:"meta"},Q={key:0,class:"artists text-hidden"},W={key:1,class:"artists text-hidden"},aa={class:"cover-item"},ea={class:"cover"},sa={class:"cover-data"},ta=N(a({__name:"CoverList",props:{data:{},type:{},cols:{default:"3 600:3 800:4 900:5 1200:6 1400:7"},loadMore:{type:Boolean},loading:{type:Boolean},loadingNum:{},loadingText:{}},emits:["loadMore"],setup(a,{emit:n}){const r=a,c=n,d=O(),N=e(),ta=s(),la=t(null),oa=p((async a=>{try{if("video"===r.type)return d.push({name:"video",query:{id:a.id}});if(N.playPlaylistId===a.id)return R.playOrPause();a.loading=!0;const e=await ia(a.id);R.updatePlayList(e,void 0,a.id)}catch(e){}finally{a.loading=!1}}),300,{leading:!0,trailing:!1}),ia=async a=>{switch(r.type){case"album":{const e=(await Y(a)).songs.map((a=>a.id)),s=await v(e);return y(s.songs)}case"playlist":{const e=await m(a,100);return y(e.songs)}case"radio":{const e=await u(a,100);return y(e.programs)}default:return[]}};return(a,e)=>{const s=V,t=S,n=z,p=D,u=$,y=q,m=A,v=B,O=L;return l(),o(T,{name:"fade",mode:"out-in"},{default:k((()=>[a.data.length>0?(l(),g("div",{key:0,class:M(["cover-list",a.type])},[f(y,{cols:a.cols,"x-gap":"20","y-gap":"20"},{default:k((()=>[(l(!0),g(h,null,_(a.data,((c,y)=>(l(),o(u,{key:y},{default:k((()=>[b("div",{class:"cover-item",onClick:a=>(a=>{d.push({name:r.type,query:{id:a.id}})})(c),onContextmenu:e=>i(la)?.openDropdown(e,c,a.type)},[b("div",G,[(l(),o(s,{key:c.cover,src:"video"===a.type?`${c.cover}?param=464y260`:c.coverSize?.m||c.cover,"default-src":"video"!==a.type?"/images/album.jpg?assest":"/images/video.jpg?assest",class:"cover-img",once:""},null,8,["src","default-src"])),c.playCount?(l(),g(h,{key:0},["album"!==a.type?(l(),g("div",H)):C("",!0),"album"!==a.type?(l(),g("div",J,[f(t,{name:"Play"}),b("span",K,P(i(x)(c.playCount||0)),1)])):C("",!0)],64)):C("",!0),c.description?(l(),g("div",U,[f(n,{class:"text-hidden"},{default:k((()=>[w(P(c.description),1)])),_:2},1024)])):C("",!0),b("div",{class:"play-btn",onClick:e[0]||(e[0]=j((()=>{}),["stop"]))},[f(p,{focusable:!1,loading:c.loading,secondary:"",circle:"",class:"play",onClick:j((a=>i(oa)(c)),["stop"])},{icon:k((()=>{return[f(t,{size:32,name:(a=c.id,N.playPlaylistId===a&&ta.playStatus?"Pause":"Play")},null,8,["name"])];var a})),_:2},1032,["loading","onClick"])])]),b("div",X,[f(n,{class:"name text-hidden"},{default:k((()=>[w(P(c.name),1)])),_:2},1024),"playlist"!==a.type&&"radio"!==a.type||!c?.creator?.id?C("",!0):(l(),o(n,{key:0,class:"creator",depth:"3"},{default:k((()=>[w(P(c.creator?.name||c.creator||"未知"),1)])),_:2},1024)),c.updateTip?(l(),o(n,{key:1,class:"tip",depth:"3"},{default:k((()=>[w(P(c.updateTip),1)])),_:2},1024)):C("",!0),"album"===a.type?(l(),g("div",F,[f(n,{class:"count",depth:"3"},{default:k((()=>[w(P(c.count||0)+"首",1)])),_:2},1024),f(n,{class:"date",depth:"3"},{default:k((()=>[w(P(i(I)(c.createTime)),1)])),_:2},1024)])):C("",!0),"video"===a.type&&c.artists?(l(),g(h,{key:3},[Array.isArray(c.artists)?(l(),g("div",Q,[(l(!0),g(h,null,_(c.artists,((a,e)=>(l(),o(n,{key:e,class:"ar"},{default:k((()=>[w(P(a.name||"未知艺术家"),1)])),_:2},1024)))),128))])):(l(),g("div",W,[f(n,{class:"ar"},{default:k((()=>[w(P(c.artists||"未知艺术家"),1)])),_:2},1024)]))],64)):C("",!0)])],40,E)])),_:2},1024)))),128))])),_:1},8,["cols"]),a.loadMore?(l(),o(m,{key:0,class:"load-more",justify:"center"},{default:k((()=>[f(p,{loading:a.loading,size:"large",strong:"",secondary:"",round:"",onClick:e[1]||(e[1]=a=>c("loadMore"))},{default:k((()=>e[2]||(e[2]=[w(" 加载更多 ")]))),_:1},8,["loading"])])),_:1})):C("",!0),f(Z,{ref_key:"coverMenuRef",ref:la,onToPlay:i(oa)},null,8,["onToPlay"])],2)):a.loading?(l(),g("div",{key:1,class:M(["cover-list","loading",a.type])},[f(y,{cols:a.cols,"x-gap":"20","y-gap":"20"},{default:k((()=>[(l(!0),g(h,null,_(a.loadingNum||50,(a=>(l(),o(u,{key:a},{default:k((()=>[b("div",aa,[b("div",ea,[f(v,{class:"cover-img"})]),b("div",sa,[f(v,{text:"",round:"",repeat:2})])])])),_:2},1024)))),128))])),_:1},8,["cols"])],2)):(l(),o(O,{key:2,description:"空空如也，怎么什么都没有啊",size:"large"}))])),_:1})}}}),[["__scopeId","data-v-63d5d2a3"]]);export{ta as _};
