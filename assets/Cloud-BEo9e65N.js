import{_ as a}from"./SongList-DlSTL_cD.js";import{d as e,as as s,r as l,L as t,f as o,g as n,S as u,o as c,bN as i,H as d,I as r,k as m,j as p,af as f,aR as v,cX as g,aj as h,ar as _,h as b,a1 as y,m as x,a2 as z,bO as S,i as k,am as j,ae as w,bJ as L,a8 as C,cf as P,d9 as B,aa as M,c6 as N,aq as R,b4 as $,K as F}from"./stores-De5JHsxi.js";import{u as G,f as H,d as I,p as O}from"./index-tqBPJ7OH.js";const q={class:"cloud"},J={class:"title"},K=F(e({__name:"Cloud",setup(e){const F=G(),K=s(),U=l(!1),W=l(!1),X=l(0),A=t(K.cloudPlayList),D=l({size:0,maxSize:0}),E=l(""),Q=l([]),T=o((()=>E.value&&Q.value.length?Q.value:A.value)),V=o((()=>"cloud"===F.currentRoute.value.name)),Y=o((()=>[{label:"批量操作",key:"batch",props:{onClick:()=>I(A.value,!1)},icon:L("Batch")}])),Z=async()=>{W.value=!0;let a=0;const e=[];do{const s=await H(500,a),l=v(s.data);X.value=s.count,D.value={size:Number((s.size/Math.pow(1024,3)).toFixed(2)),maxSize:Number((s.maxSize/Math.pow(1024,3)).toFixed(0))},e.push(...l),A.value=e,a+=500}while(a<X.value&&V.value);K.setCloudPlayList(A.value),W.value=!1};return n((()=>[E.value,A.value]),(()=>{const a=E.value.trim();if(!a||""===a||!A.value.length)return;const e=g(a,A.value);Q.value=e}),{debounce:300,maxWait:1e3}),u((()=>{U.value?Z():U.value=!0})),c(Z),(e,s)=>{const l=h,t=C,o=P,n=B,u=_,c=M,v=N,g=R,L=a,F=$,G=i("debounce");return b(),d("div",q,[r("div",J,[m(l,{class:"keyword"},{default:p((()=>s[1]||(s[1]=[y("我的云盘")]))),_:1}),m(u,{class:"status"},{default:p((()=>[m(l,{class:"item"},{default:p((()=>[m(t,{name:"Music",depth:3}),m(o,{from:0,to:x(X)||x(A)?.length||0},null,8,["to"]),s[2]||(s[2]=y(" 首 "))])),_:1}),m(l,{class:"item"},{default:p((()=>[m(t,{name:"Storage",depth:3}),m(n,{percentage:100/(x(D).maxSize/x(D).size),class:"status",type:"line"},{default:p((()=>[m(l,{class:"space",depth:"3"},{default:p((()=>[y(z(x(D).size??0)+"GB / "+z(x(D).maxSize??0)+"GB ",1)])),_:1})])),_:1},8,["percentage"])])),_:1})])),_:1})]),m(u,{class:"menu",justify:"space-between"},{default:p((()=>[m(u,{class:"left",align:"flex-end"},{default:p((()=>[S((b(),k(c,{focusable:!1,disabled:x(W)||!x(A)?.length,loading:x(W),type:"primary",strong:"",secondary:"",round:""},{icon:p((()=>[m(t,{name:"Play"})])),default:p((()=>[y(" "+z(x(W)?`\n              正在更新... (${x(A).length===x(X)?0:x(A).length}/${x(X)})`:"播放"),1)])),_:1},8,["disabled","loading"])),[[G,()=>x(O).updatePlayList(x(A))]]),m(c,{focusable:!1,class:"more",strong:"",secondary:"",circle:"",onClick:Z},{icon:p((()=>[m(t,{name:"Refresh"})])),_:1}),m(v,{options:x(Y),trigger:"click",placement:"bottom-start"},{default:p((()=>[m(c,{focusable:!1,class:"more",circle:"",strong:"",secondary:""},{icon:p((()=>[m(t,{name:"List"})])),_:1})])),_:1},8,["options"])])),_:1}),x(A)?.length?(b(),k(g,{key:0,value:x(E),"onUpdate:value":s[0]||(s[0]=a=>j(E)?E.value=a:null),"input-props":{autocomplete:"off"},class:"search",placeholder:"模糊搜索",clearable:"",round:""},{prefix:p((()=>[m(t,{name:"Search"})])),_:1},8,["value"])):w("",!0)])),_:1}),m(f,{name:"fade",mode:"out-in"},{default:p((()=>[!x(E)||x(Q)?.length?(b(),k(L,{key:0,data:x(T),loading:x(W)},null,8,["data","loading"])):(b(),k(F,{key:1,description:`搜不到关于 ${x(E)} 的任何歌曲呀`,style:{"margin-top":"60px"},size:"large"},{icon:p((()=>[m(t,{name:"SearchOff"})])),_:1},8,["description"]))])),_:1})])}}}),[["__scopeId","data-v-82464c31"]]);export{K as default};
