import{_ as a}from"./SongList-R_rcibCj.js";import{a7 as e,s,r as l,w as t,e as o,n as i,g as n,G as r,k as c,j as u,T as d,O as p,aa as m,a1 as f,J as v,P as g,R as y,i as _,L as k,K as b,X as h,W as w,Y as z,ah as j,at as C,b1 as x,aJ as I,au as $,ad as q,a0 as L,ap as R,aq as A,v as P}from"./vendor-QWMq--4w.js";import{_ as S,g as T,q as J,C as K,e as N,z as O,K as U,B,d as D,F,i as G,f as Q}from"./index-D_KQhQdT.js";import{g as W,l as X}from"./album-BZa_fuA4.js";import"./Pagination-0Aw9qrf-.js";const Y={key:0,class:"album"},E={key:0,class:"detail"},H={class:"cover"},M=(a=>(R("data-v-0fd0978e"),a=a(),A(),a))((()=>v("div",{class:"cover-loading"},[v("img",{class:"loading-img",src:Q,alt:"song"})],-1))),V={class:"data"},Z={key:1,class:"creator"},aa={key:0,class:"num-item"},ea={key:1,class:"num-item"},sa={key:2,class:"num-item"},la={key:1,class:"detail"},ta={class:"data"},oa={key:1,class:"title"},ia=S({__name:"album",setup(R){const A=e(),S=T(),{userLikeData:Q}=s(S),ia=l(A.currentRoute.value.query.id||null),na=l(null),ra=l(null),ca=l(null),ua=l([]),da=l([{label:"打开源页面链接",key:"open",props:{onclick:()=>{const a=ia.value;a&&window.open(`https://music.163.com/#/album?id=${a}`)}},icon:(pa="link",()=>P(w,null,{default:()=>P(N,{icon:pa},null)}))}]);var pa;const ma=async(a,e=!1)=>{if(!a)return!1;na.value=null,e||(ra.value=null);const s=await W(a);if(na.value=J(s.album,"album")[0],e)return!0;const l=s.songs.map((a=>a.id)).join(","),t=await K(l);ra.value=J(t.songs,"song")},fa=D((a=>{const e=a?.trim();if(!e||""===e)return!0;const s=F(e,ra.value);ua.value=s}),300),va=a=>{const e=Q.value.albums;return!e.length||!e.some((e=>e.id===Number(a)))},ga=D((async a=>{try{if(!G())return $message.warning("请登录后使用");const e=va(a)?1:2;200===(await X(e,a)).code?($message.success((1===e?"收藏":"取消收藏")+"成功"),await S.setUserLikeAlbums()):$message.error((1===e?"收藏":"取消收藏")+"失败，请重试")}catch(e){console.error("收藏出错：",e),$message.error("收藏操作出现错误")}}),300);return t((()=>A.currentRoute.value),(a=>{"album"===a.name&&(ia.value=a.query?.id,ma(ia.value))})),o((()=>{ma(ia.value)})),(e,s)=>{const l=j,t=p,o=C,R=m,P=x,S=I,T=f,J=$,K=q,D=a,F=L;return i(ia)&&Number(i(ia))?(n(),r("div",Y,[c(d,{name:"fade",mode:"out-in"},{default:u((()=>[i(na)&&Object.keys(i(na))?.length?(n(),r("div",E,[v("div",H,[c(l,{src:i(na).coverSize.l,"previewed-img-props":{style:{borderRadius:"8px"}},"preview-src":i(na).cover,class:"cover-img","show-toolbar-tooltip":"",onLoad:s[0]||(s[0]=a=>{a.target.style.opacity=1})},{placeholder:u((()=>[M])),_:1},8,["src","preview-src"]),c(l,{src:i(na).coverSize.m,class:"cover-shadow","preview-disabled":""},null,8,["src"])]),v("div",V,[c(t,{class:"name"},{default:u((()=>[g(y(i(na).name||"未知专辑"),1)])),_:1}),i(na).alia?(n(),_(t,{key:0,class:"alia",depth:"3"},{default:u((()=>[g(y(i(na).alia),1)])),_:1})):k("",!0),i(na).artists?(n(),r("div",Z,[(n(!0),r(b,null,h(i(na).artists,((a,e)=>(n(),_(t,{key:e,class:"ar",onClick:e=>i(A).push(`/artist?id=${a.id}`)},{default:u((()=>[g(y(a.name),1)])),_:2},1032,["onClick"])))),128))])):k("",!0),i(na)?.tags?(n(),_(R,{key:2,class:"tags"},{default:u((()=>[(n(!0),r(b,null,h(i(na).tags,((a,e)=>(n(),_(o,{key:e,bordered:!1,class:"pl-tags",round:"",onClick:e=>i(A).push({path:"/discover/albums",query:{cat:a}})},{default:u((()=>[g(y(a),1)])),_:2},1032,["onClick"])))),128))])),_:1})):k("",!0),c(R,{class:"num"},{default:u((()=>[i(na).count?(n(),r("div",aa,[c(i(w),{depth:"3",size:"18"},{default:u((()=>[c(i(N),{icon:"music-note"})])),_:1}),c(t,{depth:"3"},{default:u((()=>[g(y(i(na).count),1)])),_:1})])):k("",!0),i(na).share?(n(),r("div",ea,[c(i(w),{depth:"3",size:"18"},{default:u((()=>[c(i(N),{icon:"share"})])),_:1}),c(t,{depth:"3"},{default:u((()=>[g(y(i(O)(i(na)?.share||0)),1)])),_:1})])):k("",!0),i(na).publishTime?(n(),r("div",sa,[c(i(w),{depth:"3",size:"18"},{default:u((()=>[c(i(N),{icon:"clock"})])),_:1}),c(t,{depth:"3"},{default:u((()=>[g(y(i(U)(i(na).publishTime))+" 发布",1)])),_:1})])):k("",!0)])),_:1}),i(na).description?(n(),_(P,{key:3,tooltip:!1,class:"description","expand-trigger":"click","line-clamp":"2"},{default:u((()=>[c(t,{depth:"3"},{default:u((()=>[g(y(i(na).description),1)])),_:1})])),_:1})):(n(),_(t,{key:4,class:"description"},{default:u((()=>[g("太懒了吧，连简介都没写")])),_:1}))])])):(n(),r("div",la,[c(S,{class:"cover"}),v("div",ta,[c(S,{repeat:4,text:""})])]))])),_:1}),c(R,{class:"menu",justify:"space-between"},{default:u((()=>[c(R,{class:"left"},{default:u((()=>[c(T,{disabled:"empty"===i(ra),focusable:!1,type:"primary",class:"play",tag:"div",circle:"",strong:"",secondary:"",onClick:s[1]||(s[1]=a=>i(B)(i(ra)))},{icon:u((()=>[c(i(w),{size:"32"},{default:u((()=>[c(i(N),{icon:"play-arrow-rounded"})])),_:1})])),_:1},8,["disabled"]),c(T,{focusable:!1,class:"like",size:"large",tag:"div",round:"",strong:"",secondary:"",onClick:s[2]||(s[2]=a=>i(ga)(i(ia)))},{icon:u((()=>[c(i(w),null,{default:u((()=>[c(i(N),{icon:va(i(ia))?"favorite-outline-rounded":"favorite-rounded"},null,8,["icon"])])),_:1})])),default:u((()=>[g(" "+y(va(i(ia))?"收藏专辑":"取消收藏"),1)])),_:1}),c(J,{options:i(da),trigger:"hover",placement:"bottom-start"},{default:u((()=>[c(T,{focusable:!1,class:"more",size:"large",tag:"div",circle:"",strong:"",secondary:""},{icon:u((()=>[c(i(w),null,{default:u((()=>[c(i(N),{icon:"format-list-bulleted"})])),_:1})])),_:1})])),_:1},8,["options"])])),_:1}),c(R,{class:"right"},{default:u((()=>[c(d,{name:"fade",mode:"out-in"},{default:u((()=>["empty"!==i(ra)&&i(ra)?.length?(n(),_(K,{key:0,value:i(ca),"onUpdate:value":s[3]||(s[3]=a=>z(ca)?ca.value=a:null),"input-props":{autoComplete:!1},class:"search",placeholder:"模糊搜索",clearable:"",onInput:i(fa)},{prefix:u((()=>[c(i(w),{size:"18"},{default:u((()=>[c(i(N),{icon:"search-rounded"})])),_:1})])),_:1},8,["value","onInput"])):k("",!0)])),_:1})])),_:1})])),_:1}),c(d,{name:"fade",mode:"out-in"},{default:u((()=>[i(ca)?i(ua)?.length?(n(),_(D,{key:1,data:i(ua),sourceId:i(ia),showAlbum:!1},null,8,["data","sourceId"])):(n(),_(F,{key:2,description:`搜不到关于 ${i(ca)} 的任何歌曲呀`,style:{"margin-top":"60px"},size:"large"},{icon:u((()=>[c(i(w),null,{default:u((()=>[c(i(N),{icon:"search-off"})])),_:1})])),_:1},8,["description"])):(n(),_(D,{key:0,data:i(ra),sourceId:i(ia),showAlbum:!1},null,8,["data","sourceId"]))])),_:1})])):(n(),r("div",oa,[c(t,{class:"key"},{default:u((()=>[g("参数不完整")])),_:1}),c(T,{focusable:!1,class:"back",strong:"",secondary:"",onClick:s[4]||(s[4]=a=>i(A).go(-1))},{default:u((()=>[g(" 返回上一页 ")])),_:1})]))}}},[["__scopeId","data-v-0fd0978e"]]);export{ia as default};
