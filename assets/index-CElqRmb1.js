import{_ as a,g as e,q as s,d as t,i,e as l}from"./index-B903CxKP.js";import{a7 as r,s as d,r as n,w as o,e as c,ax as u,n as m,g as v,G as p,k as f,j as y,T as _,Y as g,O as h,a1 as k,aL as b,J as z,P as w,R as $,i as x,L as j,az as q,ay as C,ah as L,W as R,aa as S,b1 as U,aJ as D,aZ as J,ap as O,aq as A}from"./vendor-QWMq--4w.js";import{_ as G}from"./avatar-DeuhMYCr.js";import{a as I,l as N}from"./artist-DtP8xNm-.js";const P={key:0,class:"artist"},T={key:0,class:"detail"},W={class:"cover"},Y=(a=>(O("data-v-a2ae7b20"),a=a(),A(),a))((()=>z("div",{class:"cover-loading"},[z("img",{class:"loading-img",src:G,alt:"avatar"})],-1))),Z={class:"data"},B={class:"name"},E={key:1,class:"detail"},F={class:"data"},H={key:1,class:"title"},K=a({__name:"index",setup(a){const O=r(),A=e(),{userLikeData:G}=d(A),K=n(O.currentRoute.value.query.id),M=n(null),Q=n(O.currentRoute.value?.name??"ar-hot"),V=async a=>{try{if(!a)return!1;M.value=null;const e=await I(a);M.value=s(e.data.artist,"artist")[0],M.value.identify=e.data.identify?.imageDesc,M.value}catch(e){console.error("歌手数据获取失败：",e),$message.error("歌手数据获取失败")}},X=a=>{const e=a.replace(/^ar-/,"");O.push({path:`/artist/${e}`,query:{id:K.value}})},aa=a=>{const e=G.value.artists;return!e.length||!e.some((e=>e.id===Number(a)))},ea=t((async a=>{try{if(!i())return $message.warning("请登录后使用");const e=aa(a)?1:2;200===(await N(e,a)).code?($message.success((1===e?"关注":"取消关注")+"成功"),await A.setUserLikeArtists()):$message.error((1===e?"关注":"取消关注")+"失败，请重试")}catch(e){console.error("关注出错：",e),$message.error("关注操作出现错误")}}),300);return o((()=>O.currentRoute.value),(async a=>{Q.value="ar-"+a.path.split("/")[2],"artist"===a.path.split("/")[1]&&a.query.id!==K.value&&(K.value=a.query.id,await V(K.value))})),c((async()=>{await V(K.value)})),(a,e)=>{const s=L,t=h,i=l,r=R,d=S,n=U,o=k,c=D,A=J,G=b,I=u("router-view");return m(K)?(v(),p("div",P,[f(_,{name:"fade",mode:"out-in"},{default:y((()=>[m(M)&&Object.keys(m(M))?.length?(v(),p("div",T,[z("div",W,[f(s,{src:m(M).coverSize.m,"previewed-img-props":{style:{borderRadius:"8px"}},"preview-src":m(M).cover,class:"cover-img","show-toolbar-tooltip":"",onLoad:e[0]||(e[0]=a=>{a.target.style.opacity=1})},{placeholder:y((()=>[Y])),_:1},8,["src","preview-src"]),f(s,{src:m(M).coverSize.s,class:"cover-shadow","preview-disabled":""},null,8,["src"])]),z("div",Z,[z("div",B,[f(t,{class:"name-text"},{default:y((()=>[w($(m(M).name||"未知艺术家"),1)])),_:1}),m(M)?.alias?.length?(v(),x(t,{key:0,class:"name-alias",depth:"3"},{default:y((()=>[w($(m(M).alias[0]),1)])),_:1})):j("",!0)]),m(M)?.identify?(v(),x(t,{key:0,class:"identify",depth:"3"},{default:y((()=>[w($(m(M).identify),1)])),_:1})):j("",!0),f(d,{class:"num"},{default:y((()=>[m(M).size?.music?(v(),p("div",{key:0,class:"num-item",onClick:e[1]||(e[1]=a=>m(O).push(`/artist/songs?id=${m(K)}`))},[f(r,{depth:"3",size:"18"},{default:y((()=>[f(i,{icon:"music-note"})])),_:1}),f(t,{depth:"3"},{default:y((()=>[w($(m(M).size.music),1)])),_:1})])):j("",!0),m(M).size?.album?(v(),p("div",{key:1,class:"num-item",onClick:e[2]||(e[2]=a=>m(O).push(`/artist/albums?id=${m(K)}`))},[f(r,{depth:"3",size:"18"},{default:y((()=>[f(i,{icon:"album"})])),_:1}),f(t,{depth:"3"},{default:y((()=>[w($(m(M).size.album),1)])),_:1})])):j("",!0),m(M).size?.mv?(v(),p("div",{key:2,class:"num-item",onClick:e[3]||(e[3]=a=>m(O).push(`/artist/videos?id=${m(K)}`))},[f(r,{depth:"3",size:"18"},{default:y((()=>[f(i,{icon:"video"})])),_:1}),f(t,{depth:"3"},{default:y((()=>[w($(m(M).size.mv),1)])),_:1})])):j("",!0)])),_:1}),m(M)?.description?(v(),x(n,{key:1,tooltip:!1,"line-clamp":m(M)?.identify?2:3,class:"description","expand-trigger":"click"},{default:y((()=>[f(t,{depth:"3"},{default:y((()=>[w($(m(M).description),1)])),_:1})])),_:1},8,["line-clamp"])):(v(),x(t,{key:2,class:"description"},{default:y((()=>[w("哇！竟然没有简介")])),_:1})),f(d,{class:"menu",justify:"space-between"},{default:y((()=>[f(o,{size:"large",round:"",strong:"",secondary:"",onClick:e[4]||(e[4]=a=>m(ea)(m(K)))},{icon:y((()=>[f(r,null,{default:y((()=>[f(i,{icon:aa(m(K))?"person-add":"person-remove"},null,8,["icon"])])),_:1})])),default:y((()=>[w(" "+$(aa(m(K))?"关注歌手":"取消关注"),1)])),_:1})])),_:1})])])):(v(),p("div",E,[f(c,{class:"cover"}),z("div",F,[f(c,{repeat:4,text:""})])]))])),_:1}),f(G,{value:m(Q),"onUpdate:value":[e[5]||(e[5]=a=>g(Q)?Q.value=a:null),X],class:"tabs",type:"segment"},{default:y((()=>[f(A,{name:"ar-hot"},{default:y((()=>[w(" 热门 ")])),_:1}),f(A,{name:"ar-songs"},{default:y((()=>[w(" 单曲 ")])),_:1}),f(A,{name:"ar-albums"},{default:y((()=>[w(" 专辑 ")])),_:1}),f(A,{name:"ar-videos"},{default:y((()=>[w(" 视频 ")])),_:1})])),_:1},8,["value"]),f(I,{mvSize:m(M)?m(M).size?.mv:null},{default:y((({Component:a})=>[(v(),x(C,null,[f(_,{name:"router",mode:"out-in"},{default:y((()=>[(v(),x(q(a)))])),_:2},1024)],1024))])),_:1},8,["mvSize"])])):(v(),p("div",H,[f(t,{class:"key"},{default:y((()=>[w("参数不完整")])),_:1}),f(o,{class:"back",strong:"",secondary:"",onClick:e[6]||(e[6]=a=>m(O).go(-1))},{default:y((()=>[w(" 返回上一页 ")])),_:1})]))}}},[["__scopeId","data-v-a2ae7b20"]]);export{K as default};
