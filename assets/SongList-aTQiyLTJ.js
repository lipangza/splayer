import{d as e,as as t,aO as i,b as a,db as l,h as s,H as o,I as n,bD as r,m as d,i as u,j as c,a1 as f,a2 as p,k as y,ae as m,aA as v,aB as h,aT as g,bP as k,cV as S,cU as b,dc as z,ac as w,W as C,aj as x,a8 as B,cm as _,aI as T,K as R,q as $,r as E,o as L,G as I,M as A,at as D,L as V,w as M,dd as H,X as F,P as O,bJ as P,aV as N,b5 as q,ap as U,bh as K,c6 as G,f as j,c5 as Z,S as J,aQ as X,J as Q,de as W,af as Y,bZ as ee,bg as te,df as ie,dg as ae,ar as le,az as se,dh as oe,di as ne,ak as re,b4 as de}from"./stores-Jq5HPlpq.js";import{u as ue,p as ce,c as fe,i as pe,h as ye,j as me,k as ve,l as he,m as ge,n as ke,q as Se,r as be}from"./index-CrsIAaLK.js";const ze={class:"song-card"},we={class:"title"},Ce={class:"info"},xe={class:"name"},Be={key:0,class:"artists text-hidden"},_e={key:1,class:"artists"},Te={key:0,class:"album text-hidden"},Re=R(e({__name:"SongCard",props:{song:{},index:{},hiddenCover:{type:Boolean},hiddenAlbum:{type:Boolean},hiddenSize:{type:Boolean}},setup(e){const R=e,$=ue(),E=t(),L=i(),I=a(),A=l(R,"song"),D=async e=>{if(!C||!e||!A.value.path)return;if(A.value.cover||"/images/song.jpg?assest"===A.value.cover)return;const t=await window.electron.ipcRenderer.invoke("get-music-cover",A.value.path);if(!t)return;const{data:i,format:a}=t,l=pe.createBlobURL(i,a,A.value.path);l&&(A.value.cover=l)};return(e,t)=>{const i=x,a=B,l=ye,C=_,R=T;return s(),o("div",ze,[n("div",{class:w(["song-content",{play:d(L).playSong.id===d(A).id}])},[n("div",{class:"num",onDblclick:t[2]||(t[2]=r((()=>{}),["stop"]))},[d(L).playSong.id!==d(A).id?(s(),u(i,{key:0,depth:"3"},{default:c((()=>[f(p(e.index+1),1)])),_:1})):(s(),u(a,{key:1,size:22,name:"Music"})),y(a,{size:28,name:d(I).playStatus?"Pause":"Play",class:"status",onClick:t[0]||(t[0]=e=>d(ce).playOrPause())},null,8,["name"]),y(a,{size:28,name:"Play",class:"play",onClick:t[1]||(t[1]=e=>d(ce).addNextSong(d(A),!0))})],32),n("div",we,[e.hiddenCover?m("",!0):(s(),u(l,{key:d(A).cover,src:d(A).path?d(A).cover:d(A).coverSize?.s||d(A).cover,class:"cover","onUpdate:show":D},null,8,["src"])),n("div",Ce,[n("div",xe,[y(C,{"line-clamp":1,tooltip:{placement:"top",width:"trigger"},class:"name-text"},{default:c((()=>[f(p(d(A)?.name||"未知曲目"),1)])),_:1}),d(A)?.path&&d(A)?.quality?(s(),u(R,{key:0,bordered:!1,type:"Hi-Res"===d(A).quality?"warning":"info",class:"quality",round:""},{default:c((()=>[f(p(d(A).quality),1)])),_:1},8,["type"])):m("",!0),1===d(A).originCoverType?(s(),u(R,{key:1,bordered:!1,type:"primary",round:""},{default:c((()=>t[11]||(t[11]=[f(" 原 ")]))),_:1})):m("",!0),1===d(A).free?(s(),u(R,{key:2,bordered:!1,type:"error",round:""},{default:c((()=>t[12]||(t[12]=[f(" VIP ")]))),_:1})):m("",!0),4===d(A).free?(s(),u(R,{key:3,bordered:!1,type:"error",round:""},{default:c((()=>t[13]||(t[13]=[f(" EP ")]))),_:1})):m("",!0),d(A)?.pc?(s(),u(R,{key:4,bordered:!1,class:"cloud",type:"info",round:""},{icon:c((()=>[y(a,{name:"Cloud"})])),_:1})):m("",!0),d(A)?.mv?(s(),u(R,{key:5,bordered:!1,class:"mv",type:"warning",round:"",onClick:t[3]||(t[3]=r((e=>d($).push({name:"video",query:{id:d(A).mv}})),["stop"]))},{default:c((()=>t[14]||(t[14]=[f(" MV ")]))),_:1})):m("",!0)]),Array.isArray(d(A).artists)?(s(),o("div",Be,[(s(!0),o(v,null,h(d(A).artists,(e=>(s(),u(i,{key:e.id,class:"ar",onClick:t[4]||(t[4]=e=>d(fe)(d(A).artists))},{default:c((()=>[f(p(e.name),1)])),_:2},1024)))),128))])):"radio"===d(A).type?(s(),o("div",_e,[y(i,{class:"ar"},{default:c((()=>t[15]||(t[15]=[f(" 电台节目 ")]))),_:1})])):(s(),o("div",{key:2,class:"artists text-hidden",onClick:t[5]||(t[5]=e=>d(fe)(d(A).artists))},[y(i,{class:"ar"},{default:c((()=>[f(p(d(A).artists||"未知艺术家"),1)])),_:1})])),d(A).alia?(s(),u(i,{key:3,class:"alia text-hidden",depth:"3"},{default:c((()=>[f(p(d(A).alia),1)])),_:1})):m("",!0)])]),"radio"===d(A).type||e.hiddenAlbum?m("",!0):(s(),o("div",Te,[d(g)(d(A).album)?(s(),u(i,{key:0,class:"album-text",onClick:t[6]||(t[6]=e=>d($).push({name:"album",query:{id:d(A).album?.id}}))},{default:c((()=>[f(p(d(A).album?.name||"未知专辑"),1)])),_:1})):(s(),u(i,{key:1,class:"album-text"},{default:c((()=>[f(p(d(A).album||"未知专辑"),1)])),_:1}))])),"radio"!==d(A).type?(s(),o("div",{key:1,class:"actions",onClick:t[9]||(t[9]=r((()=>{}),["stop"])),onDblclick:t[10]||(t[10]=r((()=>{}),["stop"]))},[y(a,{name:d(E).isLikeSong(d(A).id)?"Favorite":"FavoriteBorder",size:20,onClick:t[7]||(t[7]=r((e=>d(k)(d(A),!d(E).isLikeSong(d(A).id))),["stop"])),onDelclick:t[8]||(t[8]=r((()=>{}),["stop"]))},null,8,["name"])],32)):m("",!0),"radio"===d(A).type?(s(),u(i,{key:2,class:"meta date",depth:"3"},{default:c((()=>[f(p(d(S)(d(A).updateTime)),1)])),_:1})):m("",!0),"radio"===d(A).type?(s(),u(i,{key:3,class:"meta",depth:"3"},{default:c((()=>[f(p(d(b)(d(A).playCount||0)),1)])),_:1})):m("",!0),y(i,{class:"meta",depth:"3"},{default:c((()=>[f(p(d(z)(d(A).duration)),1)])),_:1}),d(A).path&&d(A).size&&!e.hiddenSize?(s(),u(i,{key:4,class:"meta size",depth:"3"},{default:c((()=>[f(p(d(A).size)+"M ",1)])),_:1})):m("",!0)],2)])}}}),[["__scopeId","data-v-efa09bfd"]]);const $e=function(e,t,i){const{attrs:a,on:l,...s}=t;let o={};return l&&Object.entries(l).forEach((e=>{const[t,i]=e;o[`on${t[0].toUpperCase()+t.slice(1)}`]=i})),$(e,{...a,...o,...s},i)};const Ee=function(e,t,i){const{attrs:a,on:l,...s}=t;let o={};return l&&Object.entries(l).forEach((e=>{const[t,i]=e;o[`on${t[0].toUpperCase()+t.slice(1)}`]=i})),$(e,{...a,...o,...s},{default:()=>i})};const Le=function(e,t){var i;return null==(i=e.$slots)?void 0:i[t]},Ie=e({name:"ObserverItem",props:{resizeObserver:{type:ResizeObserver,require:!0},id:{type:[String,Number],require:!0}},setup:e=>(e=>{const t=E(null);return L((()=>{e.resizeObserver&&t.value&&e.resizeObserver.observe(t.value)})),I((()=>{e.resizeObserver&&t.value&&e.resizeObserver.unobserve(t.value)})),{itemRefEl:t}})(e),render(){var e;const{id:t}=this;return $e("div",{ref:"itemRefEl",attrs:{"data-id":t}},[null==(e=Le(this,"default"))?void 0:e()])}}),Ae={itemGap:0,fixed:!1,buffer:0,bufferTop:0,bufferBottom:0,scrollDistance:0,horizontal:!1,fixSelection:!1,start:0,offset:0,listStyle:"",listClass:"",itemStyle:"",itemClass:"",headerClass:"",headerStyle:"",footerClass:"",footerStyle:"",stickyHeaderClass:"",stickyHeaderStyle:"",stickyFooterClass:"",stickyFooterStyle:""};function De(e,t){const i=new Proxy(e,{get(e,t){var i;return null!=(i=Reflect.get(e,t))?i:Reflect.get(Ae,t)}}),a=E(null),l=E(null),s=E(null),o=E(null),n=E(null),r=E(null),d=new Map,u=E(0);let c="backward",f=!1,p=!1,y=!1,m=null;const v=A({clientSize:0,headerSize:0,footerSize:0,stickyHeaderSize:0,stickyFooterSize:0}),h=A({views:0,offset:0,listTotalSize:0,virtualSize:0,inViewBegin:0,inViewEnd:0,renderBegin:0,renderEnd:0,bufferTop:0,bufferBottom:0});function g(){const e=i.horizontal?"scrollLeft":"scrollTop";return a.value?a.value[e]:0}function k(){return v.headerSize+v.footerSize+v.stickyHeaderSize+v.stickyFooterSize}function S(){return h.listTotalSize+v.headerSize+v.footerSize+v.stickyHeaderSize+v.stickyFooterSize}function b(e){var t;return i.fixed?i.minSize+i.itemGap:null!=(t=d.get(String(e)))?t:i.minSize+i.itemGap}function z(e){var t,a;if(i.fixed)return{top:(i.minSize+i.itemGap)*e,current:i.minSize+i.itemGap,bottom:(i.minSize+i.itemGap)*(e+1)};const{itemKey:l}=i;let s=v.headerSize;for(let n=0;n<=e-1;n+=1){s+=b(null==(t=i.list[n])?void 0:t[l])}const o=b(null==(a=i.list[e])?void 0:a[l]);return{top:s,current:o,bottom:s+o}}function w(e){y=!0;const t=i.horizontal?"scrollLeft":"scrollTop";a.value&&(a.value[t]=e)}async function C(e){if(e<0)return;if(e>=i.list.length-1)return void x();let{top:t}=z(e);w(t);const a=()=>{const{top:i}=z(e);if(w(i),t!==i)return t=i,void(m=a);m=null};m=a}async function x(){w(S()),setTimeout((()=>{Math.abs(Math.round(h.offset+v.clientSize)-Math.round(S()))>2&&x()}),3)}function B(e){var a;e<h.inViewBegin&&(f=!0),h.inViewBegin=e,h.inViewEnd=Math.min(e+h.views,i.list.length-1),null==(a=null==t?void 0:t.rangeUpdate)||a.call(t,h.inViewBegin,h.inViewEnd)}function _(){var e,t;const{views:a,offset:l,inViewBegin:s}=h,{itemKey:o}=i,n=l-v.headerSize;let r=s,d=h.virtualSize+N(h.renderBegin,h.inViewBegin);if(n<0)B(0);else{if("forward"===c){if(n>=d)return;for(let t=r-1;t>=0;t-=1){const a=b(null==(e=i.list[t])?void 0:e[o]);if(d-=a,d<=n&&n<d+a){r=t;break}}}if("backward"===c){if(n<=d)return;for(let e=r;e<=i.list.length-1;e+=1){const a=b(null==(t=i.list[e])?void 0:t[o]);if(d<=n&&n<d+a){r=e;break}d+=a}f=!1}r!==h.inViewBegin&&B(r)}}function T(e){var a,l,s;null==(a=null==t?void 0:t.scroll)||a.call(t,e);const o=g();o!==h.offset&&(c=o<h.offset?"forward":"backward",h.offset=o,_(),"forward"===c&&h.offset-i.scrollDistance<=0&&(null==(l=null==t?void 0:t.toTop)||l.call(t,i.list[0])),"backward"===c&&Math.round(h.offset+i.scrollDistance)>=Math.round(h.listTotalSize+k()-v.clientSize)&&(null==(s=null==t?void 0:t.toBottom)||s.call(t,i.list[i.list.length-1])))}function R(){!function(){const e=Math.ceil(v.clientSize/(i.minSize+i.itemGap))+1;h.views=e}(),B(h.inViewBegin)}function $(){var e;if(i.fixed)return void(h.listTotalSize=(i.minSize+i.itemGap)*i.list.length);const{itemKey:t}=i;let a=0;for(let l=0;l<=i.list.length-1;l+=1)a+=b(null==(e=i.list[l])?void 0:e[t]);h.listTotalSize=a}function H(){h.offset=0,h.listTotalSize=0,h.virtualSize=0,h.inViewBegin=0,h.inViewEnd=0,h.renderBegin=0,h.renderEnd=0,d.clear(),F()}function F(){u.value+=1}let O;"undefined"!=typeof ResizeObserver&&(O=new ResizeObserver((e=>{var a;let l=0;for(const n of e){const e=n.target.dataset.id;if(e){const r=b(e);let u=0;if(n.borderBoxSize){const e=Array.isArray(n.borderBoxSize)?n.borderBoxSize[0]:n.borderBoxSize;u=i.horizontal?e.inlineSize:e.blockSize}else u=i.horizontal?n.contentRect.width:n.contentRect.height;"client"===e?(v.clientSize=u,R()):"header"===e?v.headerSize=u:"footer"===e?v.footerSize=u:"stickyHeader"===e?v.stickyHeaderSize=u:"stickyFooter"===e?v.stickyFooterSize=u:r!==u&&(s=e,o=u,d.set(String(s),o),l+=u-r,null==(a=null==t?void 0:t.itemResize)||a.call(t,e,u))}}var s,o;h.listTotalSize+=l,m&&m(),!f&&!p||0===l||y||(f=!1,p=!1,w(h.offset+l)),y=!1})));const P=()=>{var e;let t=0;const a=h.renderBegin;for(let l=0;l<a;l++)t+=b(null==(e=i.list[l])?void 0:e[i.itemKey]);h.virtualSize=t};function N(e,t){var a;const l=Math.min(e,t),s=Math.max(e,t);let o=0;for(let n=l;n<s;n+=1)o+=b(null==(a=i.list[n])?void 0:a[i.itemKey]);return o}D((()=>{i.bufferTop?h.bufferTop=i.bufferTop:h.bufferTop=i.buffer,i.bufferBottom?h.bufferBottom=i.bufferBottom:h.bufferBottom=i.buffer})),L((()=>{a.value&&(a.value.addEventListener("scroll",T),null==O||O.observe(a.value)),n.value&&(null==O||O.observe(n.value)),r.value&&(null==O||O.observe(r.value)),s.value&&(null==O||O.observe(s.value)),o.value&&(null==O||O.observe(o.value)),i.start?C(i.start):i.offset&&w(i.offset)})),I((()=>{a.value&&(a.value.removeEventListener("scroll",T),null==O||O.unobserve(a.value),v.clientSize=0),n.value&&(null==O||O.unobserve(n.value),v.stickyHeaderSize=0),r.value&&(null==O||O.unobserve(r.value),v.stickyFooterSize=0),s.value&&(null==O||O.unobserve(s.value),v.headerSize=0),o.value&&(null==O||O.unobserve(o.value),v.footerSize=0)}));const q=V([]);return M((()=>[h.inViewBegin,h.inViewEnd,u.value]),((e,t)=>{if(e&&t){const[t]=e,a=h.renderBegin;let l=t,s=h.inViewEnd;if(l=Math.max(0,l-h.bufferTop),s=Math.min(s+h.bufferBottom,i.list.length-1>0?i.list.length-1:0),null==i?void 0:i.renderControl){const{begin:e,end:a}=i.renderControl(t,h.inViewEnd);l=e,s=a}h.renderBegin=l,h.renderEnd=s,l>a?h.virtualSize+=N(l,a):h.virtualSize-=N(l,a),q.value=i.list.slice(h.renderBegin,h.renderEnd+1)}}),{immediate:!0}),M((()=>i.list.length),(()=>{i.list.length<=0?H():($(),B(h.inViewBegin),P(),F())}),{immediate:!0}),{props:i,renderList:q,clientRefEl:a,listRefEl:l,headerRefEl:s,footerRefEl:o,stickyHeaderRefEl:n,stickyFooterRefEl:r,reactiveData:h,slotSize:v,sizesMap:d,resizeObserver:O,getReactiveData:function(){return h},getOffset:g,getSlotSize:k,reset:H,scrollToIndex:C,manualRender:function(e,t){const a=h.renderBegin;h.renderBegin=e,h.renderEnd=t,e>a?h.virtualSize+=N(e,a):h.virtualSize-=N(e,a),q.value=i.list.slice(h.renderBegin,h.renderEnd+1),P()},scrollIntoView:async function(e){var t;const{top:a,bottom:l}=z(e),s=g(),o=g()+v.clientSize,n=b(null==(t=i.list[e])?void 0:t[i.itemKey]);a<s&&s<l&&n<v.clientSize?w(a):a+v.stickyHeaderSize<o&&o<l+v.stickyHeaderSize&&n<v.clientSize?w(l-v.clientSize+v.stickyHeaderSize):(a+v.stickyHeaderSize>=o||l<=s)&&C(e)},scrollToTop:async function e(){w(0),setTimeout((()=>{var t;const l=i.horizontal?"scrollLeft":"scrollTop";0!==(null==(t=null==a?void 0:a.value)?void 0:t[l])&&e()}),3)},scrollToBottom:x,scrollToOffset:w,getItemSize:b,deleteItemSize:function(e){d.delete(String(e))},deletedList2Top:function(e){$();let t=0;e.forEach((e=>{t+=b(e[i.itemKey])})),P(),w(h.offset-t),_()},addedList2Top:function(e){$();let t=0;e.forEach((e=>{t+=b(e[i.itemKey])})),P(),w(h.offset+t),p=!0,y=!1,_()},getItemPosByIndex:z,forceUpdate:F}}const Ve=e({name:"VirtList",emits:{scroll:e=>e,toTop:e=>e,toBottom:e=>e,itemResize:(e,t)=>!0,rangeUpdate:(e,t)=>!0},props:{list:{type:Array,default:()=>[]},itemKey:{type:[String,Number],required:!0},minSize:{type:Number,default:20,required:!0},itemGap:{type:Number,default:0},renderControl:{type:Function,default:void 0},fixed:{type:Boolean,default:!1},buffer:{type:Number,default:0},bufferTop:{type:Number,default:0},bufferBottom:{type:Number,default:0},scrollDistance:{type:Number,default:0},horizontal:{type:Boolean,default:!1},start:{type:Number,default:0},offset:{type:Number,default:0},listStyle:{type:String,default:""},listClass:{type:String,default:""},itemStyle:{type:String,default:""},itemClass:{type:String,default:""},headerClass:{type:String,default:""},headerStyle:{type:String,default:""},footerClass:{type:String,default:""},footerStyle:{type:String,default:""},stickyHeaderClass:{type:String,default:""},stickyHeaderStyle:{type:String,default:""},stickyFooterClass:{type:String,default:""},stickyFooterStyle:{type:String,default:""}},setup:(e,t)=>De(e,{scroll:e=>{t.emit("scroll",e)},toTop:e=>{t.emit("toTop",e)},toBottom:e=>{t.emit("toBottom",e)},itemResize:(e,i)=>{t.emit("itemResize",e,i)},rangeUpdate:(e,i)=>{t.emit("rangeUpdate",e,i)}}),render(){const{renderList:e,reactiveData:t,resizeObserver:i}=this,{itemGap:a,itemKey:l,horizontal:s,listStyle:o,listClass:n,itemStyle:r,itemClass:d,headerClass:u,headerStyle:c,footerClass:f,footerStyle:p,stickyHeaderClass:y,stickyHeaderStyle:m,stickyFooterClass:v,stickyFooterStyle:h}=this.props,{listTotalSize:g,virtualSize:k,renderBegin:S}=t,b=a>0?`padding: ${a/2}px 0; `:"";return $e("div",{ref:"clientRefEl",class:"virt-list__client",style:"width: 100%; height: 100%; overflow: auto;",attrs:{"data-id":"client"}},[(()=>{var e;return Le(this,"stickyHeader")?$e("div",{key:"slot-sticky-header",class:y,style:`position: sticky; z-index: 10; ${s?"left: 0":"top: 0;"} ${m}`,ref:"stickyHeaderRefEl",attrs:{"data-id":"stickyHeader"}},[null==(e=Le(this,"stickyHeader"))?void 0:e()]):null})(),(()=>{var e;return Le(this,"header")?$e("div",{key:"slot-header",class:u,style:c,ref:"headerRefEl",attrs:{"data-id":"header"}},[null==(e=Le(this,"header"))?void 0:e()]):null})(),(()=>{var t,a;const u=[];for(let s=0;s<e.length;s+=1){const a=e[s];u.push(Ee(Ie,{key:a[l],class:d,style:`${b}${r}`,attrs:{id:a[l],resizeObserver:i}},null==(t=Le(this,"default"))?void 0:t({itemData:a,index:S+s})))}if(0===u.length&&Le(this,"empty")){const e=this.slotSize.clientSize-this.getSlotSize();u.push($e("div",{key:`slot-empty-${e}`,style:`height: ${e}px`},[null==(a=Le(this,"empty"))?void 0:a()]))}return $e("div",{ref:"listRefEl",class:n,style:s?`will-change: width; min-width: ${g}px; display: flex; ${o}`:`will-change: height; min-height: ${g}px; ${o}`},[$e("div",{style:s?`width: ${k}px; will-change: width;`:`height: ${k}px; will-change: height;`}),u])})(),(()=>{var e;return Le(this,"footer")?$e("div",{key:"slot-footer",class:f,style:p,ref:"footerRefEl",attrs:{"data-id":"footer"}},[null==(e=Le(this,"footer"))?void 0:e()]):null})(),(()=>{var e;return Le(this,"stickyFooter")?$e("div",{key:"slot-sticky-footer",class:v,style:`position: sticky; z-index: 10; ${s?"right: 0":"bottom: 0;"} ${h}`,ref:"stickyFooterRefEl",attrs:{"data-id":"stickyFooter"}},[null==(e=Le(this,"stickyFooter"))?void 0:e()]):null})()])}}),Me=e({__name:"SongListMenu",emits:["removeSong"],setup(e,{expose:i,emit:l}){const o=l,n=ue(),r=t(),c=H(),f=a(),p=E(0),y=E(0),m=E(!1),v=E([]),h=(e,t,i)=>{e.path&&window.$dialog.warning({title:"确认删除",content:()=>$("div",{style:{marginTop:"20px"}},[$(U,{showIcon:!1},{default:()=>e.path}),$("div",{style:{marginTop:"20px"}},["确认从本地磁盘中删除 ",$("strong",null,e.name),"？该操作无法撤销！"])]),positiveText:"删除",negativeText:"取消",onPositiveClick:async()=>{await window.electron.ipcRenderer.invoke("delete-file",e.path)?(t.splice(i,1),c.deleteLocalSong(i),ce.removeSongIndex(i),window.$message.success(`${e.name} 删除成功`)):window.$message.error(`${e.name} 删除失败，请重试`)}})},g=(e,t)=>{window.$dialog.warning({title:"确认删除",content:`确认从云盘中删除 ${e.name}？该操作无法撤销！`,positiveText:"删除",negativeText:"取消",onPositiveClick:async()=>{200==(await ke(e.id)).code?(r.cloudPlayList.splice(t,1),r.setCloudPlayList(r.cloudPlayList),f.playIndex===t&&ce.nextOrPrev("next"),window.$message.success("删除成功")):window.$message.error("删除失败，请重试")}})},k=async e=>{if(!e?.id)return;const t=await K(e.id),i=t?.data?.[0],{id:a,type:l,size:s,br:o,md5:n}=i,r=await Se(e?.name,l,s,Math.floor(o/1e3),n,a);if(200===r.code){const e=r?.data?.failed?.[0];-200!==e?.code?window.$message.success("导入成功"):window.$message.error(e?.msg||"导入失败，请重试")}else window.$message.error("导入失败，请重试")};return i({openDropdown:(e,t,i,a,l,s)=>{try{e.preventDefault(),m.value=!1;const d=r.userLikeData.playlists?.filter((e=>e.userId===r.userData.userId)),u=!!i?.mv&&0!==i.mv,c="cloud"===n.currentRoute.value.name,S=!!i?.path,b=1===F(),z=f.playIndex===a,w=!!s&&d.some((e=>e.id===s));O().then((()=>{v.value=[{key:"play",label:"立即播放",props:{onClick:()=>ce.addNextSong(i,!0)},icon:P("Play",{size:18})},{key:"play-next",label:"下一首播放",show:!z&&!f.personalFmMode,props:{onClick:()=>ce.addNextSong(i,!1)},icon:P("PlayNext",{size:18})},{key:"playlist-add",label:"添加到歌单",props:{onClick:()=>me([i],S)},icon:P("AddList",{size:18})},{key:"mv",label:"观看 MV",show:"song"===l&&u,props:{onClick:()=>n.push({name:"video",query:{id:i.mv,type:"mv"}})},icon:P("Video",{size:18})},{key:"line-1",type:"divider"},{key:"more",label:"更多操作",icon:P("Menu",{size:18}),children:[{key:"code-name",label:`复制${"song"===l?"歌曲":"节目"}名称`,props:{onClick:()=>N(i.name)},icon:P("Copy",{size:18})},{key:"code-id",label:`复制${"song"===l?"歌曲":"节目"} ID`,show:!S,props:{onClick:()=>N(i.id)},icon:P("Copy",{size:18})},{key:"share",label:`分享${"song"===l?"歌曲":"节目"}链接`,show:!S,props:{onClick:()=>N(`https://music.163.com/#/${l}?id=${i.id}`,"已复制分享链接到剪切板")},icon:P("Share",{size:18})},{key:"line-2",type:"divider",show:S},{key:"meta-edit",label:"音乐标签编辑",show:S,props:{onClick:()=>{i.path&&ve(i)}},icon:P("EditNote",{size:20})}]},{key:"line-two",type:"divider"},{key:"cloud-import",label:"导入至云盘",show:!c&&b&&"song"===l&&!S,props:{onClick:()=>k(i)},icon:P("Cloud")},{key:"delete",label:"从歌单中删除",show:w&&b&&!c,props:{onClick:()=>q(s,[i.id],(()=>o("removeSong",[i.id])))},icon:P("Delete")},{key:"cloud-delete",label:"从云盘中删除",show:c,props:{onClick:()=>g(i,a)},icon:P("Delete")},{key:"delete",label:"从本地磁盘中删除",show:S&&!z,props:{onClick:()=>h(i,t,a)},icon:P("Delete")},{key:"open-folder",label:"打开歌曲所在目录",show:S,props:{onClick:()=>window.electron.ipcRenderer.send("open-folder",i.path)},icon:P("SnippetFolder")},{key:"cloud-match",label:"云盘歌曲纠正",show:c,props:{onClick:()=>he(i?.id,a)},icon:P("AutoFix")},{key:"search",label:"同名搜索",props:{onClick:()=>n.push({name:"search",query:{keyword:i.name}})},icon:P("Search")},{key:"download",label:"下载歌曲",show:!S&&"song"===l,props:{onClick:()=>ge(i)},icon:P("Download")}],p.value=e.clientX,y.value=e.clientY,m.value=!0}))}catch(d){console.error("右键菜单出现异常：",d),window.$message.error("右键菜单出现异常")}}}),(e,t)=>{const i=G;return s(),u(i,{x:d(p),y:d(y),show:d(m),options:d(v),class:"song-list-menu",placement:"bottom-start",trigger:"manual",size:"large",onSelect:t[0]||(t[0]=e=>m.value=!1),onClickoutside:t[1]||(t[1]=e=>m.value=!1)},null,8,["x","y","show","options"])}}}),He={class:"list-header song-card"},Fe={class:"title has-sort"},Oe={class:"load-more"},Pe={key:1,class:"song-list loading"},Ne=R(e({__name:"SongList",props:{data:{},type:{default:"song"},height:{},loading:{type:Boolean},loadMore:{type:Boolean},loadingText:{default:"努力加载中..."},hiddenAlbum:{type:Boolean},hiddenCover:{type:Boolean},hiddenSize:{type:Boolean},hiddenScrollbar:{type:Boolean},disabledSort:{type:Boolean},playListId:{default:0}},emits:["reachBottom","scroll","removeSong"],setup(e,{emit:t}){const l=e,v=t,h=i(),g=a(),k=E(0),S=E(0),b=E(null),z=E(null),C=E(!0),_=E(null),T=j((()=>{const e=te(l.data);if(l.disabledSort)return e;switch(g.listSort){case"titleAZ":return e.sort(((e,t)=>e.name.localeCompare(t.name)));case"titleZA":return e.sort(((e,t)=>t.name.localeCompare(e.name)));case"arAZ":return e.sort(((e,t)=>{const i=Array.isArray(e.artists)?e.artists[0].name:e.artists,a=Array.isArray(t.artists)?t.artists[0].name:t.artists;return i.localeCompare(a)}));case"arZA":return e.sort(((e,t)=>{const i=Array.isArray(e.artists)?e.artists[0].name:e.artists;return(Array.isArray(t.artists)?t.artists[0].name:t.artists).localeCompare(i)}));case"timeDown":return e.sort(((e,t)=>t.duration-e.duration));case"timeUp":return e.sort(((e,t)=>e.duration-t.duration));case"dateDown":return e.sort(((e,t)=>(t.updateTime||0)-(e.updateTime||0)));case"dateUp":return e.sort(((e,t)=>(e.updateTime||0)-(t.updateTime||0)));default:return e}})),R=j((()=>T.value.findIndex((e=>e.id===h.playSong.id)))),{height:$,stop:L}=Z(z),A=j((()=>ie(W).map((([e,{name:t,show:i,icon:a}])=>({key:e,label:t,show:"all"===i||i===l.type,icon:P(a)}))))),D=e=>{v("scroll",e),S.value=e.target.scrollTop},V=e=>{l.loading||v("reachBottom",e)},M=e=>{g.listSort=e,h.playPlaylistId===l.playListId&&ce.updatePlayList(T.value,h.playSong,l.playListId,{showTip:!1,play:!1,scrobble:!1}),b.value?.scrollToIndex(R.value||0)},H=e=>v("removeSong",e);return be((()=>{k.value=b.value?.getOffset()||0,C.value=!1})),J((()=>{C.value=!0,"auto"===l.height&&L(),k.value>0&&b.value?.scrollToOffset(k.value)})),I((()=>{L(),C.value=!1})),(e,t)=>{const i=x,a=G,l=Re,v=ae,h=le,E=se,L=B,I=oe,F=ne,O=re,P=de;return s(),u(Y,{name:"fade",mode:"out-in"},{default:c((()=>[d(X)(d(T))?e.loading?(s(),o("div",Pe,[y(O,{repeat:10,text:""})])):(s(),u(P,{key:2,description:"列表光秃秃的，啥都没有哦",size:"large",class:"song-list empty"})):(s(),o("div",{key:0,ref_key:"songListRef",ref:z,class:w(["song-list",{"hidden-scrollbar":e.hiddenScrollbar}])},[y(Y,{name:"fade",mode:"out-in"},{default:c((()=>[(s(),u(d(Ve),{ref_key:"listRef",ref:b,key:d(T)?.[0]?.id,list:d(T),minSize:94,buffer:2,offset:d(k),style:Q({height:"auto"===e.height?"auto":`${e.height||d($)}px`}),itemKey:"id",onScroll:D,onToBottom:V},{stickyHeader:c((()=>[n("div",He,[y(i,{class:"num"},{default:c((()=>t[2]||(t[2]=[f("#")]))),_:1}),e.disabledSort?(s(),u(i,{key:1,class:"title"},{default:c((()=>t[4]||(t[4]=[f("标题")]))),_:1})):(s(),u(a,{key:0,options:d(A),trigger:"click",placement:"bottom-start",onSelect:M},{default:c((()=>[n("div",Fe,[y(i,null,{default:c((()=>t[3]||(t[3]=[f("标题")]))),_:1}),"default"!==d(g).listSort?(s(),u(i,{key:0,class:"sort",depth:"3"},{default:c((()=>[f(p(d(W)[d(g).listSort].name),1)])),_:1})):m("",!0)])])),_:1},8,["options"])),"radio"===e.type||e.hiddenAlbum?m("",!0):(s(),u(i,{key:2,class:"album"},{default:c((()=>t[5]||(t[5]=[f("专辑")]))),_:1})),"radio"!==e.type?(s(),u(i,{key:3,class:"actions"},{default:c((()=>t[6]||(t[6]=[f("操作")]))),_:1})):m("",!0),"radio"===e.type?(s(),u(i,{key:4,class:"meta date"},{default:c((()=>t[7]||(t[7]=[f("更新日期")]))),_:1})):m("",!0),"radio"===e.type?(s(),u(i,{key:5,class:"meta"},{default:c((()=>t[8]||(t[8]=[f("播放量")]))),_:1})):m("",!0),y(i,{class:"meta"},{default:c((()=>t[9]||(t[9]=[f("时长")]))),_:1}),e.data?.[0].size&&!e.hiddenSize?(s(),u(i,{key:6,class:"meta size"},{default:c((()=>t[10]||(t[10]=[f("大小")]))),_:1})):m("",!0)])])),default:c((({itemData:t,index:i})=>[y(l,{song:t,index:i,hiddenCover:e.hiddenCover,hiddenAlbum:e.hiddenAlbum,hiddenSize:e.hiddenSize,onDblclick:r((i=>d(ce).updatePlayList(d(T),t,e.playListId)),["stop"]),onContextmenu:r((a=>d(_)?.openDropdown(a,d(T),t,i,e.type,e.playListId)),["stop"])},null,8,["song","index","hiddenCover","hiddenAlbum","hiddenSize","onDblclick","onContextmenu"])])),footer:c((()=>[n("div",Oe,[e.loadMore&&e.loading?(s(),u(h,{key:0},{default:c((()=>[y(v,{size:"small"}),y(i,null,{default:c((()=>[f(p(e.loadingText||"努力加载中"),1)])),_:1})])),_:1})):(s(),u(E,{key:1,dashed:""},{default:c((()=>t[11]||(t[11]=[f(" 没有更多啦 ~ ")]))),_:1}))])])),_:1},8,["list","offset","style"]))])),_:1}),y(Me,{ref_key:"songListMenuRef",ref:_,onRemoveSong:H},null,512),(s(),u(ee,{to:"body"},[y(Y,{name:"fade",mode:"out-in"},{default:c((()=>[d(C)?(s(),u(F,{key:0,class:"list-menu"},{default:c((()=>[y(Y,{name:"fade",mode:"out-in"},{default:c((()=>[d(S)>100?(s(),u(I,{key:0,width:"42",onClick:t[0]||(t[0]=e=>d(b)?.scrollToTop())},{default:c((()=>[y(L,{size:22,name:"Up"})])),_:1})):m("",!0)])),_:1}),d(R)>=0?(s(),u(I,{key:0,width:"42",onClick:t[1]||(t[1]=e=>d(b)?.scrollToIndex(d(R)))},{default:c((()=>[y(L,{size:22,name:"Location"})])),_:1})):m("",!0)])),_:1})):m("",!0)])),_:1})]))],2))])),_:1})}}}),[["__scopeId","data-v-a1e1bd28"]]);export{Ne as _};
