import{_ as a}from"./Pagination-0Aw9qrf-.js";import{g as e,a as s,_ as t}from"./CommentList-Db2c7R81.js";import{_ as l,C as o,q as n,e as r,f as i}from"./index-D_KQhQdT.js";import{a7 as u,r as c,w as m,f as d,g as v,G as f,k as g,j as p,T as y,i as _,n as h,J as C,R as k,K as b,X as w,P as x,L as j,ah as q,W as I,aw as N,b0 as P,O as R,ap as z,aq as L,a0 as A}from"./vendor-QWMq--4w.js";import"./avatar-DeuhMYCr.js";const T=a=>(z("data-v-00f9ff6a"),a=a(),L(),a),$={class:"comment"},B=T((()=>C("div",{class:"cover-loading"},[C("img",{class:"loading-img",src:i,alt:"loading-img"})],-1))),D={class:"content"},E={class:"name"},G={class:"artist"},J={key:0,class:"all-ar"},K={key:1,class:"all-ar"},O={class:"ar"},Q={key:0,class:"all-comments"},S=T((()=>C("div",{id:"to-comments"},null,-1))),U=l({__name:"Comment",setup(l){const i=u(),z=c(i.currentRoute.value.query.id),L=c(null),T=c(1),U=c(null),V=c(null),W=async a=>{try{const e=await o(a),s=n(e?.songs?.[0],"song");L.value=s?.[0]??null}catch(e){console.error("获取歌曲详情失败：",e)}},X=async(a,t=1,l=3,o=20)=>{try{const n=1!==t&&"0"!==U.value?.cursor?U.value.cursor:null,[r,i]=await Promise.all([1===t?e(a,0,10):null,s(a,0,t,l,o,n)]);if(0===i?.data.totalCount)return U.value="empty";U.value=i?.data,V.value=r?.hotComments?.[0]?r.hotComments:"no-comment"}catch(n){console.error("获取评论数据出错：",n),$message.error("获取评论数据出错")}},F=async a=>{T.value=a,await X(i.currentRoute.value.query.id,a),H()},H=()=>{const a=document.getElementById("to-comments");a&&a.scrollIntoView({behavior:"smooth"})};return m((()=>i.currentRoute.value),(a=>{"comment"==a.name&&(T.value=1,U.value=null,V.value=null,W(a.query.id),X(a.query.id))})),d((()=>{(a=>{if(!a)$message.error("参数不完整"),i.go(-1)})(z.value),W(z.value),X(z.value)})),(e,s)=>{const l=q,o=r,n=I,i=N,u=P,c=t,m=R,d=a,W=A;return v(),f("div",$,[g(y,{name:"fade",mode:"out-in"},{default:p((()=>[(v(),_(i,{key:h(z),"content-style":{display:"flex",flexDirection:"row",alignItems:"center",padding:"16px",height:"100%"},class:"song-detail"},{default:p((()=>[g(l,{src:h(L)?.coverSize?.s||h(L)?.cover,class:"cover-img","preview-disabled":"",onLoad:s[0]||(s[0]=a=>{a.target.style.opacity=1})},{placeholder:p((()=>[B])),_:1},8,["src"]),C("div",D,[C("div",E,k(h(L)?.name||"未知曲目"),1),C("div",G,[g(n,{depth:"3",size:"20"},{default:p((()=>[g(o,{icon:"account-music"})])),_:1}),h(L)?.artists&&Array.isArray(h(L)?.artists)?(v(),f("div",J,[(v(!0),f(b,null,w(h(L).artists,(a=>(v(),f("span",{key:a.id,class:"ar"},k(a.name),1)))),128))])):(v(),f("div",K,[C("span",O,k(h(L)?.artists||"未知艺术家"),1)]))])])])),_:1}))])),_:1}),g(y,{name:"fade",mode:"out-in"},{default:p((()=>["empty"!==h(U)?(v(),f("div",Q,[S,1===h(T)&&"no-comment"!==h(V)?(v(),f(b,{key:0},[g(u,{class:"title",prefix:"bar"},{default:p((()=>[x("热门评论 ")])),_:1}),g(c,{data:h(V),loadingNum:10},null,8,["data"])],64)):j("",!0),g(u,{class:"title",prefix:"bar"},{default:p((()=>[g(m,null,{default:p((()=>[x("全部评论")])),_:1}),h(U)?.totalCount?(v(),_(m,{key:0,class:"num",depth:"3"},{default:p((()=>[x(k(h(U).totalCount)+" + ",1)])),_:1})):j("",!0)])),_:1}),g(c,{data:h(U)?.comments},null,8,["data"]),g(d,{totalCount:h(U)?.totalCount,pageNumber:h(T),onPageNumberChange:F},null,8,["totalCount","pageNumber"])])):(v(),_(W,{key:1,description:"很抱歉，该歌曲暂无评论",style:{"margin-top":"60px"},size:"large"}))])),_:1})])}}},[["__scopeId","data-v-00f9ff6a"]]);export{U as default};
